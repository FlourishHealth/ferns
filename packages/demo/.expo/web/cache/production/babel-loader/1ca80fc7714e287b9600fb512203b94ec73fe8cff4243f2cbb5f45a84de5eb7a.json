{"ast":null,"code":"'use strict';import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _toPropertyKey(arg){var key=_toPrimitive(arg,\"string\");return typeof key===\"symbol\"?key:String(key);}function _toPrimitive(input,hint){if(typeof input!==\"object\"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||\"default\");if(typeof res!==\"object\")return res;throw new TypeError(\"@@toPrimitive must return a primitive value.\");}return(hint===\"string\"?String:Number)(input);}import Sensor from'./Sensor';export var SensorContainer=function(){function SensorContainer(){_classCallCheck(this,SensorContainer);_defineProperty(this,\"nativeSensors\",new Map());}_createClass(SensorContainer,[{key:\"getSensorId\",value:function getSensorId(sensorType,config){return sensorType*100+config.iosReferenceFrame*10+Number(config.adjustToInterfaceOrientation);}},{key:\"initializeSensor\",value:function initializeSensor(sensorType,config){var sensorId=this.getSensorId(sensorType,config);if(!this.nativeSensors.has(sensorId)){var newSensor=new Sensor(sensorType,config);this.nativeSensors.set(sensorId,newSensor);}var sensor=this.nativeSensors.get(sensorId);return sensor.getSharedValue();}},{key:\"registerSensor\",value:function registerSensor(sensorType,config,handler){var sensorId=this.getSensorId(sensorType,config);if(!this.nativeSensors.has(sensorId)){return-1;}var sensor=this.nativeSensors.get(sensorId);if(sensor&&sensor.isAvailable()&&(sensor.isRunning()||sensor.register(handler))){sensor.listenersNumber++;return sensorId;}return-1;}},{key:\"unregisterSensor\",value:function unregisterSensor(sensorId){if(this.nativeSensors.has(sensorId)){var sensor=this.nativeSensors.get(sensorId);if(sensor&&sensor.isRunning()){sensor.listenersNumber--;if(sensor.listenersNumber===0){sensor.unregister();}}}}}]);return SensorContainer;}();","map":{"version":3,"names":["_classCallCheck","_createClass","_defineProperty","obj","key","value","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","Sensor","SensorContainer","Map","getSensorId","sensorType","config","iosReferenceFrame","adjustToInterfaceOrientation","initializeSensor","sensorId","nativeSensors","has","newSensor","set","sensor","get","getSharedValue","registerSensor","handler","isAvailable","isRunning","register","listenersNumber","unregisterSensor","unregister"],"sources":["/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/SensorContainer.ts"],"sourcesContent":["'use strict';\nimport type {\n  SensorType,\n  SensorConfig,\n  Value3D,\n  ValueRotation,\n  ShareableRef,\n  SharedValue,\n} from './commonTypes';\nimport Sensor from './Sensor';\n\nexport class SensorContainer {\n  private nativeSensors: Map<number, Sensor> = new Map();\n\n  getSensorId(sensorType: SensorType, config: SensorConfig) {\n    return (\n      sensorType * 100 +\n      config.iosReferenceFrame * 10 +\n      Number(config.adjustToInterfaceOrientation)\n    );\n  }\n\n  initializeSensor(\n    sensorType: SensorType,\n    config: SensorConfig\n  ): SharedValue<Value3D | ValueRotation> {\n    const sensorId = this.getSensorId(sensorType, config);\n\n    if (!this.nativeSensors.has(sensorId)) {\n      const newSensor = new Sensor(sensorType, config);\n      this.nativeSensors.set(sensorId, newSensor);\n    }\n\n    const sensor = this.nativeSensors.get(sensorId);\n    return sensor!.getSharedValue();\n  }\n\n  registerSensor(\n    sensorType: SensorType,\n    config: SensorConfig,\n    handler: ShareableRef<(data: Value3D | ValueRotation) => void>\n  ): number {\n    const sensorId = this.getSensorId(sensorType, config);\n\n    if (!this.nativeSensors.has(sensorId)) {\n      return -1;\n    }\n\n    const sensor = this.nativeSensors.get(sensorId);\n    if (\n      sensor &&\n      sensor.isAvailable() &&\n      (sensor.isRunning() || sensor.register(handler))\n    ) {\n      sensor.listenersNumber++;\n      return sensorId;\n    }\n    return -1;\n  }\n\n  unregisterSensor(sensorId: number) {\n    if (this.nativeSensors.has(sensorId)) {\n      const sensor = this.nativeSensors.get(sensorId);\n      if (sensor && sensor.isRunning()) {\n        sensor.listenersNumber--;\n        if (sensor.listenersNumber === 0) {\n          sensor.unregister();\n        }\n      }\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}