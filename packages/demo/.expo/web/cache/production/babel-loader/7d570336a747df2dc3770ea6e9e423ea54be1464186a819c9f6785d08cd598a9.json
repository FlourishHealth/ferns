{"ast":null,"code":"'use strict';import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _defineProperty2 from\"@babel/runtime/helpers/defineProperty\";function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty2(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _toPropertyKey(arg){var key=_toPrimitive(arg,\"string\");return typeof key===\"symbol\"?key:String(key);}function _toPrimitive(input,hint){if(typeof input!==\"object\"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||\"default\");if(typeof res!==\"object\")return res;throw new TypeError(\"@@toPrimitive must return a primitive value.\");}return(hint===\"string\"?String:Number)(input);}import{registerEventHandler,unregisterEventHandler}from'./core';import{shouldBeUseWeb}from'./PlatformChecker';var SHOULD_BE_USE_WEB=shouldBeUseWeb();function jsListener(eventName,handler){return function(evt){handler(_objectSpread(_objectSpread({},evt.nativeEvent),{},{eventName:eventName}));};}var WorkletEventHandler=function(){function WorkletEventHandler(worklet){_classCallCheck(this,WorkletEventHandler);var eventNames=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];_defineProperty(this,\"worklet\",void 0);_defineProperty(this,\"eventNames\",void 0);_defineProperty(this,\"reattachNeeded\",void 0);_defineProperty(this,\"listeners\",void 0);_defineProperty(this,\"viewTag\",void 0);_defineProperty(this,\"registrations\",void 0);this.worklet=worklet;this.eventNames=eventNames;this.reattachNeeded=false;this.listeners={};this.viewTag=undefined;this.registrations=[];if(SHOULD_BE_USE_WEB){this.listeners=eventNames.reduce(function(acc,eventName){acc[eventName]=jsListener(eventName,worklet);return acc;},{});}}_createClass(WorkletEventHandler,[{key:\"updateWorklet\",value:function updateWorklet(newWorklet){this.worklet=newWorklet;this.reattachNeeded=true;}},{key:\"registerForEvents\",value:function registerForEvents(viewTag,fallbackEventName){var _this=this;this.viewTag=viewTag;this.registrations=this.eventNames.map(function(eventName){return registerEventHandler(_this.worklet,eventName,viewTag);});if(this.registrations.length===0&&fallbackEventName){this.registrations.push(registerEventHandler(this.worklet,fallbackEventName,viewTag));}}},{key:\"registerForEventByName\",value:function registerForEventByName(eventName){this.registrations.push(registerEventHandler(this.worklet,eventName));}},{key:\"unregisterFromEvents\",value:function unregisterFromEvents(){this.registrations.forEach(function(id){return unregisterEventHandler(id);});this.registrations=[];}}]);return WorkletEventHandler;}();export{WorkletEventHandler as default};","map":{"version":3,"names":["_classCallCheck","_createClass","_defineProperty2","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","getOwnPropertyDescriptors","defineProperties","defineProperty","_defineProperty","obj","key","value","_toPropertyKey","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","registerEventHandler","unregisterEventHandler","shouldBeUseWeb","SHOULD_BE_USE_WEB","jsListener","eventName","handler","evt","nativeEvent","WorkletEventHandler","worklet","eventNames","reattachNeeded","listeners","viewTag","registrations","reduce","acc","updateWorklet","newWorklet","registerForEvents","fallbackEventName","_this","map","registerForEventByName","unregisterFromEvents","id","default"],"sources":["/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/WorkletEventHandler.ts"],"sourcesContent":["'use strict';\nimport type { NativeSyntheticEvent } from 'react-native';\nimport { registerEventHandler, unregisterEventHandler } from './core';\nimport type { EventPayload, ReanimatedEvent } from './hook/commonTypes';\nimport { shouldBeUseWeb } from './PlatformChecker';\n\nconst SHOULD_BE_USE_WEB = shouldBeUseWeb();\n\ntype JSEvent<Event extends object> = NativeSyntheticEvent<EventPayload<Event>>;\n\n// In JS implementation (e.g. for web) we don't use Reanimated's\n// event emitter, therefore we have to handle here\n// the event that came from React Native and convert it.\nfunction jsListener<Event extends object>(\n  eventName: string,\n  handler: (event: ReanimatedEvent<Event>) => void\n) {\n  return (evt: JSEvent<Event>) => {\n    handler({ ...evt.nativeEvent, eventName } as ReanimatedEvent<Event>);\n  };\n}\n\nexport default class WorkletEventHandler<Event extends object> {\n  worklet: (event: ReanimatedEvent<Event>) => void;\n  eventNames: string[];\n  reattachNeeded: boolean;\n  listeners:\n    | Record<string, (event: ReanimatedEvent<ReanimatedEvent<Event>>) => void>\n    | Record<string, (event: JSEvent<Event>) => void>;\n\n  viewTag: number | undefined;\n  registrations: number[];\n  constructor(\n    worklet: (event: ReanimatedEvent<Event>) => void,\n    eventNames: string[] = []\n  ) {\n    this.worklet = worklet;\n    this.eventNames = eventNames;\n    this.reattachNeeded = false;\n    this.listeners = {};\n    this.viewTag = undefined;\n    this.registrations = [];\n\n    if (SHOULD_BE_USE_WEB) {\n      this.listeners = eventNames.reduce(\n        (\n          acc: Record<string, (event: JSEvent<Event>) => void>,\n          eventName: string\n        ) => {\n          acc[eventName] = jsListener(eventName, worklet);\n          return acc;\n        },\n        {}\n      );\n    }\n  }\n\n  updateWorklet(newWorklet: (event: ReanimatedEvent<Event>) => void): void {\n    this.worklet = newWorklet;\n    this.reattachNeeded = true;\n  }\n\n  registerForEvents(viewTag: number, fallbackEventName?: string): void {\n    this.viewTag = viewTag;\n    this.registrations = this.eventNames.map((eventName) =>\n      registerEventHandler(this.worklet, eventName, viewTag)\n    );\n    if (this.registrations.length === 0 && fallbackEventName) {\n      this.registrations.push(\n        registerEventHandler(this.worklet, fallbackEventName, viewTag)\n      );\n    }\n  }\n\n  registerForEventByName(eventName: string) {\n    this.registrations.push(registerEventHandler(this.worklet, eventName));\n  }\n\n  unregisterFromEvents(): void {\n    this.registrations.forEach((id) => unregisterEventHandler(id));\n    this.registrations = [];\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}