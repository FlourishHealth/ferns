{"ast":null,"code":"'use strict';import _defineProperty2 from\"@babel/runtime/helpers/defineProperty\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty2(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _toPropertyKey(arg){var key=_toPrimitive(arg,\"string\");return typeof key===\"symbol\"?key:String(key);}function _toPrimitive(input,hint){if(typeof input!==\"object\"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||\"default\");if(typeof res!==\"object\")return res;throw new TypeError(\"@@toPrimitive must return a primitive value.\");}return(hint===\"string\"?String:Number)(input);}import{isSharedValue}from'../reanimated2';import{isChromeDebugger}from'../reanimated2/PlatformChecker';import WorkletEventHandler from'../reanimated2/WorkletEventHandler';import{initialUpdaterRun}from'../reanimated2/animation';import{hasInlineStyles,getInlineStyle}from'./InlinePropManager';import{flattenArray,has}from'./utils';import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";function dummyListener(){}export var PropsFilter=function(){function PropsFilter(){_classCallCheck(this,PropsFilter);_defineProperty(this,\"_initialStyle\",{});}_createClass(PropsFilter,[{key:\"filterNonAnimatedProps\",value:function filterNonAnimatedProps(component){var _this=this;var inputProps=component.props;var props={};var _loop=function _loop(){var value=inputProps[key];if(key==='style'){var styleProp=inputProps.style;var styles=flattenArray(styleProp!=null?styleProp:[]);var processedStyle=styles.map(function(style){if(style&&style.viewDescriptors){style.viewsRef.add(component);if(component._isFirstRender){_this._initialStyle=_objectSpread(_objectSpread(_objectSpread({},style.initial.value),_this._initialStyle),initialUpdaterRun(style.initial.updater));}return _this._initialStyle;}else if(hasInlineStyles(style)){return getInlineStyle(style,component._isFirstRender);}else{return style;}});props[key]=StyleSheet.flatten(processedStyle);}else if(key==='animatedProps'){var animatedProp=inputProps.animatedProps;if(animatedProp.initial!==undefined){Object.keys(animatedProp.initial.value).forEach(function(key){var _animatedProp$initial,_animatedProp$viewsRe;props[key]=(_animatedProp$initial=animatedProp.initial)===null||_animatedProp$initial===void 0?void 0:_animatedProp$initial.value[key];(_animatedProp$viewsRe=animatedProp.viewsRef)===null||_animatedProp$viewsRe===void 0?void 0:_animatedProp$viewsRe.add(component);});}}else if(has('current',value)&&value.current instanceof WorkletEventHandler){if(value.current.eventNames.length>0){value.current.eventNames.forEach(function(eventName){props[eventName]=has('listeners',value.current)?value.current.listeners[eventName]:dummyListener;});}else{props[key]=dummyListener;}}else if(isSharedValue(value)){if(component._isFirstRender){props[key]=value.value;}}else if(key!=='onGestureHandlerStateChange'||!isChromeDebugger()){props[key]=value;}};for(var key in inputProps){_loop();}return props;}}]);return PropsFilter;}();","map":{"version":3,"names":["_defineProperty2","_classCallCheck","_createClass","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","o","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","getOwnPropertyDescriptors","defineProperties","defineProperty","_defineProperty","obj","key","value","_toPropertyKey","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","isSharedValue","isChromeDebugger","WorkletEventHandler","initialUpdaterRun","hasInlineStyles","getInlineStyle","flattenArray","has","StyleSheet","dummyListener","PropsFilter","filterNonAnimatedProps","component","_this","inputProps","props","_loop","styleProp","style","styles","processedStyle","map","viewDescriptors","viewsRef","add","_isFirstRender","_initialStyle","initial","updater","flatten","animatedProp","animatedProps","_animatedProp$initial","_animatedProp$viewsRe","current","eventNames","eventName","listeners"],"sources":["/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/createAnimatedComponent/PropsFilter.tsx"],"sourcesContent":["'use strict';\nimport type { StyleProps, SharedValue } from '../reanimated2';\nimport { isSharedValue } from '../reanimated2';\nimport { isChromeDebugger } from '../reanimated2/PlatformChecker';\nimport WorkletEventHandler from '../reanimated2/WorkletEventHandler';\nimport { initialUpdaterRun } from '../reanimated2/animation';\nimport { hasInlineStyles, getInlineStyle } from './InlinePropManager';\nimport type {\n  AnimatedComponentProps,\n  AnimatedProps,\n  InitialComponentProps,\n  IAnimatedComponentInternal,\n  IPropsFilter,\n} from './commonTypes';\nimport { flattenArray, has } from './utils';\nimport { StyleSheet } from 'react-native';\n\nfunction dummyListener() {\n  // empty listener we use to assign to listener properties for which animated\n  // event is used.\n}\n\nexport class PropsFilter implements IPropsFilter {\n  private _initialStyle = {};\n\n  public filterNonAnimatedProps(\n    component: React.Component<unknown, unknown> & IAnimatedComponentInternal\n  ): Record<string, unknown> {\n    const inputProps =\n      component.props as AnimatedComponentProps<InitialComponentProps>;\n    const props: Record<string, unknown> = {};\n    for (const key in inputProps) {\n      const value = inputProps[key];\n      if (key === 'style') {\n        const styleProp = inputProps.style;\n        const styles = flattenArray<StyleProps>(styleProp ?? []);\n        const processedStyle: StyleProps = styles.map((style) => {\n          if (style && style.viewDescriptors) {\n            // this is how we recognize styles returned by useAnimatedStyle\n            style.viewsRef.add(component);\n            if (component._isFirstRender) {\n              this._initialStyle = {\n                ...style.initial.value,\n                ...this._initialStyle,\n                ...initialUpdaterRun<StyleProps>(style.initial.updater),\n              };\n            }\n            return this._initialStyle;\n          } else if (hasInlineStyles(style)) {\n            return getInlineStyle(style, component._isFirstRender);\n          } else {\n            return style;\n          }\n        });\n        props[key] = StyleSheet.flatten(processedStyle);\n      } else if (key === 'animatedProps') {\n        const animatedProp = inputProps.animatedProps as Partial<\n          AnimatedComponentProps<AnimatedProps>\n        >;\n        if (animatedProp.initial !== undefined) {\n          Object.keys(animatedProp.initial.value).forEach((key) => {\n            props[key] = animatedProp.initial?.value[key];\n            animatedProp.viewsRef?.add(component);\n          });\n        }\n      } else if (\n        has('current', value) &&\n        value.current instanceof WorkletEventHandler\n      ) {\n        if (value.current.eventNames.length > 0) {\n          value.current.eventNames.forEach((eventName) => {\n            props[eventName] = has('listeners', value.current)\n              ? (value.current.listeners as Record<string, unknown>)[eventName]\n              : dummyListener;\n          });\n        } else {\n          props[key] = dummyListener;\n        }\n      } else if (isSharedValue(value)) {\n        if (component._isFirstRender) {\n          props[key] = (value as SharedValue<unknown>).value;\n        }\n      } else if (key !== 'onGestureHandlerStateChange' || !isChromeDebugger()) {\n        props[key] = value;\n      }\n    }\n    return props;\n  }\n}\n"],"mappings":"AAAA,YAAY,QAAAA,gBAAA,oDAAAC,eAAA,oDAAAC,YAAA,mDAAAC,QAAAC,CAAA,CAAAC,CAAA,MAAAC,CAAA,CAAAC,MAAA,CAAAC,IAAA,CAAAJ,CAAA,KAAAG,MAAA,CAAAE,qBAAA,MAAAC,CAAA,CAAAH,MAAA,CAAAE,qBAAA,CAAAL,CAAA,EAAAC,CAAA,GAAAK,CAAA,CAAAA,CAAA,CAAAC,MAAA,UAAAN,CAAA,SAAAE,MAAA,CAAAK,wBAAA,CAAAR,CAAA,CAAAC,CAAA,EAAAQ,UAAA,KAAAP,CAAA,CAAAQ,IAAA,CAAAC,KAAA,CAAAT,CAAA,CAAAI,CAAA,UAAAJ,CAAA,WAAAU,cAAAZ,CAAA,UAAAC,CAAA,GAAAA,CAAA,CAAAY,SAAA,CAAAC,MAAA,CAAAb,CAAA,QAAAC,CAAA,OAAAW,SAAA,CAAAZ,CAAA,EAAAY,SAAA,CAAAZ,CAAA,KAAAA,CAAA,GAAAF,OAAA,CAAAI,MAAA,CAAAD,CAAA,MAAAa,OAAA,UAAAd,CAAA,EAAAL,gBAAA,CAAAI,CAAA,CAAAC,CAAA,CAAAC,CAAA,CAAAD,CAAA,MAAAE,MAAA,CAAAa,yBAAA,CAAAb,MAAA,CAAAc,gBAAA,CAAAjB,CAAA,CAAAG,MAAA,CAAAa,yBAAA,CAAAd,CAAA,GAAAH,OAAA,CAAAI,MAAA,CAAAD,CAAA,GAAAa,OAAA,UAAAd,CAAA,EAAAE,MAAA,CAAAe,cAAA,CAAAlB,CAAA,CAAAC,CAAA,CAAAE,MAAA,CAAAK,wBAAA,CAAAN,CAAA,CAAAD,CAAA,cAAAD,CAAA,EAAC,SAAAmB,gBAAAC,GAAA,CAAAC,GAAA,CAAAC,KAAA,EAAAD,GAAA,CAAAE,cAAA,CAAAF,GAAA,KAAAA,GAAA,IAAAD,GAAA,EAAAjB,MAAA,CAAAe,cAAA,CAAAE,GAAA,CAAAC,GAAA,EAAAC,KAAA,CAAAA,KAAA,CAAAb,UAAA,MAAAe,YAAA,MAAAC,QAAA,cAAAL,GAAA,CAAAC,GAAA,EAAAC,KAAA,SAAAF,GAAA,WAAAG,eAAAG,GAAA,MAAAL,GAAA,CAAAM,YAAA,CAAAD,GAAA,yBAAAL,GAAA,YAAAA,GAAA,CAAAO,MAAA,CAAAP,GAAA,YAAAM,aAAAE,KAAA,CAAAC,IAAA,YAAAD,KAAA,aAAAA,KAAA,eAAAA,KAAA,KAAAE,IAAA,CAAAF,KAAA,CAAAG,MAAA,CAAAC,WAAA,KAAAF,IAAA,GAAAG,SAAA,MAAAC,GAAA,CAAAJ,IAAA,CAAAK,IAAA,CAAAP,KAAA,CAAAC,IAAA,uBAAAK,GAAA,mBAAAA,GAAA,WAAAE,SAAA,yDAAAP,IAAA,YAAAF,MAAA,CAAAU,MAAA,EAAAT,KAAA,GAEb,OAASU,aAAa,KAAQ,gBAAgB,CAC9C,OAASC,gBAAgB,KAAQ,gCAAgC,CACjE,MAAO,CAAAC,mBAAmB,KAAM,oCAAoC,CACpE,OAASC,iBAAiB,KAAQ,0BAA0B,CAC5D,OAASC,eAAe,CAAEC,cAAc,KAAQ,qBAAqB,CAQrE,OAASC,YAAY,CAAEC,GAAG,KAAQ,SAAS,QAAAC,UAAA,gDAG3C,QAAS,CAAAC,aAAaA,CAAA,CAAG,CAEvB,CAGF,UAAa,CAAAC,WAAW,YAAyB,SAAAA,YAAA,EAAApD,eAAA,MAAAoD,WAAA,EAAA9B,eAAA,sBACvB,CAAC,CAAC,GAAArB,YAAA,CAAAmD,WAAA,GAAA5B,GAAA,0BAAAC,KAAA,CAEnB,SAAA4B,uBACLC,SAAyE,CAChD,KAAAC,KAAA,MACzB,GAAM,CAAAC,UAAU,CACdF,SAAS,CAACG,KAAsD,CAClE,GAAM,CAAAA,KAA8B,CAAG,CAAC,CAAC,KAAAC,KAAA,UAAAA,MAAA,CACX,CAC5B,GAAM,CAAAjC,KAAK,CAAG+B,UAAU,CAAChC,GAAG,CAAC,CAC7B,GAAIA,GAAG,GAAK,OAAO,CAAE,CACnB,GAAM,CAAAmC,SAAS,CAAGH,UAAU,CAACI,KAAK,CAClC,GAAM,CAAAC,MAAM,CAAGb,YAAY,CAAaW,SAAS,OAATA,SAAS,CAAI,EAAE,CAAC,CACxD,GAAM,CAAAG,cAA0B,CAAGD,MAAM,CAACE,GAAG,CAAE,SAAAH,KAAK,CAAK,CACvD,GAAIA,KAAK,EAAIA,KAAK,CAACI,eAAe,CAAE,CAElCJ,KAAK,CAACK,QAAQ,CAACC,GAAG,CAACZ,SAAS,CAAC,CAC7B,GAAIA,SAAS,CAACa,cAAc,CAAE,CAC5BZ,KAAI,CAACa,aAAa,CAAArD,aAAA,CAAAA,aAAA,CAAAA,aAAA,IACb6C,KAAK,CAACS,OAAO,CAAC5C,KAAK,EACnB8B,KAAI,CAACa,aAAa,EAClBvB,iBAAiB,CAAae,KAAK,CAACS,OAAO,CAACC,OAAO,EACvD,CACH,CACA,MAAO,CAAAf,KAAI,CAACa,aAAa,CAC3B,CAAC,IAAM,IAAItB,eAAe,CAACc,KAAK,CAAC,CAAE,CACjC,MAAO,CAAAb,cAAc,CAACa,KAAK,CAAEN,SAAS,CAACa,cAAc,CAAC,CACxD,CAAC,IAAM,CACL,MAAO,CAAAP,KAAK,CACd,CACF,CAAC,CAAC,CACFH,KAAK,CAACjC,GAAG,CAAC,CAAG0B,UAAU,CAACqB,OAAO,CAACT,cAAc,CAAC,CACjD,CAAC,IAAM,IAAItC,GAAG,GAAK,eAAe,CAAE,CAClC,GAAM,CAAAgD,YAAY,CAAGhB,UAAU,CAACiB,aAE/B,CACD,GAAID,YAAY,CAACH,OAAO,GAAKhC,SAAS,CAAE,CACtC/B,MAAM,CAACC,IAAI,CAACiE,YAAY,CAACH,OAAO,CAAC5C,KAAK,CAAC,CAACP,OAAO,CAAE,SAAAM,GAAG,CAAK,KAAAkD,qBAAA,CAAAC,qBAAA,CACvDlB,KAAK,CAACjC,GAAG,CAAC,EAAAkD,qBAAA,CAAGF,YAAY,CAACH,OAAO,UAAAK,qBAAA,iBAApBA,qBAAA,CAAsBjD,KAAK,CAACD,GAAG,CAAC,CAC7C,CAAAmD,qBAAA,CAAAH,YAAY,CAACP,QAAQ,UAAAU,qBAAA,iBAArBA,qBAAA,CAAuBT,GAAG,CAACZ,SAAS,CAAC,CACvC,CAAC,CAAC,CACJ,CACF,CAAC,IAAM,IACLL,GAAG,CAAC,SAAS,CAAExB,KAAK,CAAC,EACrBA,KAAK,CAACmD,OAAO,WAAY,CAAAhC,mBAAmB,CAC5C,CACA,GAAInB,KAAK,CAACmD,OAAO,CAACC,UAAU,CAAC5D,MAAM,CAAG,CAAC,CAAE,CACvCQ,KAAK,CAACmD,OAAO,CAACC,UAAU,CAAC3D,OAAO,CAAE,SAAA4D,SAAS,CAAK,CAC9CrB,KAAK,CAACqB,SAAS,CAAC,CAAG7B,GAAG,CAAC,WAAW,CAAExB,KAAK,CAACmD,OAAO,CAAC,CAC7CnD,KAAK,CAACmD,OAAO,CAACG,SAAS,CAA6BD,SAAS,CAAC,CAC/D3B,aAAa,CACnB,CAAC,CAAC,CACJ,CAAC,IAAM,CACLM,KAAK,CAACjC,GAAG,CAAC,CAAG2B,aAAa,CAC5B,CACF,CAAC,IAAM,IAAIT,aAAa,CAACjB,KAAK,CAAC,CAAE,CAC/B,GAAI6B,SAAS,CAACa,cAAc,CAAE,CAC5BV,KAAK,CAACjC,GAAG,CAAC,CAAIC,KAAK,CAA0BA,KAAK,CACpD,CACF,CAAC,IAAM,IAAID,GAAG,GAAK,6BAA6B,EAAI,CAACmB,gBAAgB,EAAE,CAAE,CACvEc,KAAK,CAACjC,GAAG,CAAC,CAAGC,KAAK,CACpB,CACF,EAtDA,IAAK,GAAM,CAAAD,GAAG,GAAI,CAAAgC,UAAU,EAAAE,KAAA,IAuD5B,MAAO,CAAAD,KAAK,CACd,YAAAL,WAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}