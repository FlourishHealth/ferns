{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import*as React from\"react\";import{useContext}from\"react\";import Dimensions from\"react-native-web/dist/exports/Dimensions\";import Platform from\"react-native-web/dist/exports/Platform\";import Pressable from\"react-native-web/dist/exports/Pressable\";import View from\"react-native-web/dist/exports/View\";import{Portal}from\"react-native-portalize\";import{Text}from\"./Text\";import{ThemeContext}from\"./Theme\";var TOOLTIP_OFFSET=8;var TOOLTIP_OVERFLOW_PADDING=20;var overflowLeft=function overflowLeft(x){return x<TOOLTIP_OVERFLOW_PADDING;};var overflowRight=function overflowRight(x){var _Dimensions$get=Dimensions.get(\"window\"),layoutWidth=_Dimensions$get.width;return x+TOOLTIP_OVERFLOW_PADDING>layoutWidth;};var getTooltipPosition=function getTooltipPosition(_ref){var children=_ref.children,tooltip=_ref.tooltip,measured=_ref.measured,idealDirection=_ref.idealDirection;if(!measured){console.debug(\"No measurements for child yet, cannot show tooltip yet.\");return{};}var childrenY=children.pageY,childrenHeight=children.height,childrenX=children.pageX,childrenWidth=children.width;var tooltipWidth=tooltip.width,tooltipHeight=tooltip.height;var horizontalCenter=childrenX+childrenWidth/2;var right=childrenX+childrenWidth+TOOLTIP_OFFSET;var left=childrenX-tooltipWidth-TOOLTIP_OFFSET;var top=childrenY-tooltipHeight-TOOLTIP_OFFSET;var bottom=childrenY+childrenHeight+TOOLTIP_OFFSET;var verticalCenter=top+childrenHeight+TOOLTIP_OFFSET;var overflowTop=top<TOOLTIP_OVERFLOW_PADDING;var overflowBottom=bottom+tooltipHeight+TOOLTIP_OVERFLOW_PADDING>Dimensions.get(\"window\").height;if(idealDirection===\"left\"&&!overflowLeft(left)){return{left:left,top:verticalCenter};}else if(idealDirection===\"right\"&&!overflowRight(right+tooltipWidth)){return{left:right,top:verticalCenter};}else if(idealDirection===\"bottom\"&&!overflowBottom&&!overflowLeft(horizontalCenter-tooltipWidth)&&!overflowRight(horizontalCenter+tooltipWidth)){return{left:horizontalCenter-tooltipWidth/2,top:bottom};}else{var y=top;if(idealDirection===\"bottom\"&&!overflowBottom||overflowTop){y=bottom;}if(!overflowLeft(horizontalCenter-tooltipWidth)&&!overflowRight(horizontalCenter+tooltipWidth)){return{left:horizontalCenter-tooltipWidth/2,top:y};}else if(overflowLeft(horizontalCenter-tooltipWidth)){return{left:TOOLTIP_OVERFLOW_PADDING,top:y};}else{return{left:Dimensions.get(\"window\").width-TOOLTIP_OVERFLOW_PADDING-tooltipWidth,top:y};}}};export var Tooltip=function Tooltip(props){var _useContext=useContext(ThemeContext),theme=_useContext.theme;var text=props.text,children=props.children,bgColor=props.bgColor,idealDirection=props.idealDirection;var hoverDelay=500;var hoverEndDelay=0;var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),visible=_React$useState2[0],setVisible=_React$useState2[1];var _React$useState3=React.useState({children:{},tooltip:{},measured:false}),_React$useState4=_slicedToArray(_React$useState3,2),measurement=_React$useState4[0],setMeasurement=_React$useState4[1];var showTooltipTimer=React.useRef();var hideTooltipTimer=React.useRef();var childrenWrapperRef=React.useRef();var touched=React.useRef(false);var isWeb=\"web\"===\"web\";React.useEffect(function(){return function(){if(showTooltipTimer.current){clearTimeout(showTooltipTimer.current);}if(hideTooltipTimer.current){clearTimeout(hideTooltipTimer.current);}};},[]);var handleOnLayout=function handleOnLayout(_ref2){var layout=_ref2.nativeEvent.layout;var _a,_b;if((childrenWrapperRef===null||childrenWrapperRef===void 0?void 0:childrenWrapperRef.current)&&!((_a=childrenWrapperRef===null||childrenWrapperRef===void 0?void 0:childrenWrapperRef.current)===null||_a===void 0?void 0:_a.measure)){console.error(\"Tooltip: childrenWrapperRef does not have a measure method.\");return;}else if(!(childrenWrapperRef===null||childrenWrapperRef===void 0?void 0:childrenWrapperRef.current)){console.error(\"Tooltip: childrenWrapperRef is null.\");}(_b=childrenWrapperRef===null||childrenWrapperRef===void 0?void 0:childrenWrapperRef.current)===null||_b===void 0?void 0:_b.measure(function(_x,_y,width,height,pageX,pageY){setMeasurement({children:{pageX:pageX,pageY:pageY,height:height,width:width},tooltip:Object.assign({},layout),measured:true});});};var handleTouchStart=function handleTouchStart(){if(hideTooltipTimer.current){clearTimeout(hideTooltipTimer.current);}showTooltipTimer.current=setTimeout(function(){touched.current=true;setVisible(true);},100);};var handleHoverIn=function handleHoverIn(){if(hideTooltipTimer.current){clearTimeout(hideTooltipTimer.current);}showTooltipTimer.current=setTimeout(function(){touched.current=true;setVisible(true);},hoverDelay);};var handleHoverOut=function handleHoverOut(){touched.current=false;if(showTooltipTimer.current){clearTimeout(showTooltipTimer.current);}hideTooltipTimer.current=setTimeout(function(){setVisible(false);setMeasurement({children:{},tooltip:{},measured:false});},hoverEndDelay);};var mobilePressProps={onPress:React.useCallback(function(){var _a,_b;if(touched.current){return null;}else{return(_b=(_a=children.props).onClick)===null||_b===void 0?void 0:_b.call(_a);}},[children.props])};if(!text){return children;}return React.createElement(React.Fragment,null,visible&&(React.createElement(Portal,null,React.createElement(Pressable,{style:Object.assign(Object.assign({alignSelf:\"flex-start\",justifyContent:\"center\",paddingHorizontal:16,backgroundColor:theme[bgColor!==null&&bgColor!==void 0?bgColor:\"darkGray\"],borderRadius:16,paddingVertical:8,display:\"flex\",flexShrink:1,maxWidth:Math.max(Dimensions.get(\"window\").width-32,300)},getTooltipPosition(Object.assign(Object.assign({},measurement),{idealDirection:idealDirection}))),measurement.measured?{opacity:1}:{opacity:0}),testID:\"tooltip-container\",onLayout:handleOnLayout,onPress:function onPress(){setVisible(false);}},React.createElement(Text,{color:\"white\"},text)))),React.createElement(View,Object.assign({ref:childrenWrapperRef,onPointerEnter:function onPointerEnter(){var _a,_b;handleHoverIn();(_b=(_a=children.props).onHoverIn)===null||_b===void 0?void 0:_b.call(_a);},onPointerLeave:function onPointerLeave(){var _a,_b;handleHoverOut();(_b=(_a=children.props).onHoverOut)===null||_b===void 0?void 0:_b.call(_a);},onTouchStart:handleTouchStart},!isWeb&&mobilePressProps),children));};","map":{"version":3,"sources":["../src/Tooltip.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import * as React from \"react\";\nimport { useContext } from \"react\";\nimport { Dimensions, Platform, Pressable, View, } from \"react-native\";\nimport { Portal } from \"react-native-portalize\";\nimport { Text } from \"./Text\";\nimport { ThemeContext } from \"./Theme\";\nconst TOOLTIP_OFFSET = 8;\n// How many pixels to leave between the tooltip and the edge of the screen\nconst TOOLTIP_OVERFLOW_PADDING = 20;\nconst overflowLeft = (x) => {\n    return x < TOOLTIP_OVERFLOW_PADDING;\n};\nconst overflowRight = (x) => {\n    const { width: layoutWidth } = Dimensions.get(\"window\");\n    return x + TOOLTIP_OVERFLOW_PADDING > layoutWidth;\n};\nconst getTooltipPosition = ({ children, tooltip, measured, idealDirection, }) => {\n    if (!measured) {\n        console.debug(\"No measurements for child yet, cannot show tooltip yet.\");\n        return {};\n    }\n    const { pageY: childrenY, height: childrenHeight, pageX: childrenX, width: childrenWidth, } = children;\n    const { width: tooltipWidth, height: tooltipHeight } = tooltip;\n    const horizontalCenter = childrenX + childrenWidth / 2;\n    const right = childrenX + childrenWidth + TOOLTIP_OFFSET;\n    const left = childrenX - tooltipWidth - TOOLTIP_OFFSET;\n    const top = childrenY - tooltipHeight - TOOLTIP_OFFSET;\n    const bottom = childrenY + childrenHeight + TOOLTIP_OFFSET;\n    const verticalCenter = top + childrenHeight + TOOLTIP_OFFSET;\n    // Top is overflowed if it would go off either side or the top of the screen.\n    const overflowTop = top < TOOLTIP_OVERFLOW_PADDING;\n    // Bottom is overflowed if it would go off either side or the bottom of the screen.\n    const overflowBottom = bottom + tooltipHeight + TOOLTIP_OVERFLOW_PADDING > Dimensions.get(\"window\").height;\n    // If it would overflow to the right, try to put it above, if not, put it on the left.\n    // If it would overflow to the left, try to put it above, if not, put it to the right.\n    // Happy path:\n    if (idealDirection === \"left\" && !overflowLeft(left)) {\n        return { left, top: verticalCenter };\n    }\n    else if (idealDirection === \"right\" && !overflowRight(right + tooltipWidth)) {\n        return { left: right, top: verticalCenter };\n    }\n    else if (idealDirection === \"bottom\" &&\n        !overflowBottom &&\n        !overflowLeft(horizontalCenter - tooltipWidth) &&\n        !overflowRight(horizontalCenter + tooltipWidth)) {\n        return { left: horizontalCenter - tooltipWidth / 2, top: bottom };\n    }\n    else {\n        // At this point, we're either trying to place it above or below, and force it into the\n        // viewport.\n        let y = top;\n        if ((idealDirection === \"bottom\" && !overflowBottom) || overflowTop) {\n            y = bottom;\n        }\n        // If it fits in the viewport, center it above the child.\n        if (!overflowLeft(horizontalCenter - tooltipWidth) &&\n            !overflowRight(horizontalCenter + tooltipWidth)) {\n            return { left: horizontalCenter - tooltipWidth / 2, top: y };\n        }\n        // Failing that, if it fits on the left, put it there, otherwise to the right.\n        // We know it's smaller than the viewport.\n        else if (overflowLeft(horizontalCenter - tooltipWidth)) {\n            return { left: TOOLTIP_OVERFLOW_PADDING, top: y };\n        }\n        else {\n            return {\n                left: Dimensions.get(\"window\").width - TOOLTIP_OVERFLOW_PADDING - tooltipWidth,\n                top: y,\n            };\n        }\n    }\n};\nexport const Tooltip = (props) => {\n    const { theme } = useContext(ThemeContext);\n    const { text, children, bgColor, idealDirection } = props;\n    const hoverDelay = 500;\n    const hoverEndDelay = 0;\n    const [visible, setVisible] = React.useState(false);\n    const [measurement, setMeasurement] = React.useState({\n        children: {},\n        tooltip: {},\n        measured: false,\n    });\n    const showTooltipTimer = React.useRef();\n    const hideTooltipTimer = React.useRef();\n    const childrenWrapperRef = React.useRef();\n    const touched = React.useRef(false);\n    const isWeb = Platform.OS === \"web\";\n    // If the tooltip is visible, and the user clicks outside of the tooltip, hide it.\n    React.useEffect(() => {\n        return () => {\n            if (showTooltipTimer.current) {\n                clearTimeout(showTooltipTimer.current);\n            }\n            if (hideTooltipTimer.current) {\n                clearTimeout(hideTooltipTimer.current);\n            }\n        };\n    }, []);\n    const handleOnLayout = ({ nativeEvent: { layout } }) => {\n        var _a, _b;\n        if ((childrenWrapperRef === null || childrenWrapperRef === void 0 ? void 0 : childrenWrapperRef.current) && !((_a = childrenWrapperRef === null || childrenWrapperRef === void 0 ? void 0 : childrenWrapperRef.current) === null || _a === void 0 ? void 0 : _a.measure)) {\n            console.error(\"Tooltip: childrenWrapperRef does not have a measure method.\");\n            return;\n        }\n        else if (!(childrenWrapperRef === null || childrenWrapperRef === void 0 ? void 0 : childrenWrapperRef.current)) {\n            console.error(\"Tooltip: childrenWrapperRef is null.\");\n        }\n        (_b = childrenWrapperRef === null || childrenWrapperRef === void 0 ? void 0 : childrenWrapperRef.current) === null || _b === void 0 ? void 0 : _b.measure((_x, _y, width, height, pageX, pageY) => {\n            setMeasurement({\n                children: { pageX, pageY, height, width },\n                tooltip: Object.assign({}, layout),\n                measured: true,\n            });\n        });\n    };\n    const handleTouchStart = () => {\n        if (hideTooltipTimer.current) {\n            clearTimeout(hideTooltipTimer.current);\n        }\n        showTooltipTimer.current = setTimeout(() => {\n            touched.current = true;\n            setVisible(true);\n        }, 100);\n    };\n    const handleHoverIn = () => {\n        if (hideTooltipTimer.current) {\n            clearTimeout(hideTooltipTimer.current);\n        }\n        showTooltipTimer.current = setTimeout(() => {\n            touched.current = true;\n            setVisible(true);\n        }, hoverDelay);\n    };\n    const handleHoverOut = () => {\n        touched.current = false;\n        if (showTooltipTimer.current) {\n            clearTimeout(showTooltipTimer.current);\n        }\n        hideTooltipTimer.current = setTimeout(() => {\n            setVisible(false);\n            setMeasurement({ children: {}, tooltip: {}, measured: false });\n        }, hoverEndDelay);\n    };\n    const mobilePressProps = {\n        onPress: React.useCallback(() => {\n            var _a, _b;\n            if (touched.current) {\n                return null;\n            }\n            else {\n                return (_b = (_a = children.props).onClick) === null || _b === void 0 ? void 0 : _b.call(_a);\n            }\n        }, [children.props]),\n    };\n    // Allow disabling tooltips when there is no string,\n    // otherwise you need to wrap the children in a function to determine if there should be a tooltip\n    // or not, which gets messy.\n    if (!text) {\n        return children;\n    }\n    return (React.createElement(React.Fragment, null,\n        visible && (React.createElement(Portal, null,\n            React.createElement(Pressable, { style: Object.assign(Object.assign({ alignSelf: \"flex-start\", justifyContent: \"center\", paddingHorizontal: 16, backgroundColor: theme[bgColor !== null && bgColor !== void 0 ? bgColor : \"darkGray\"], borderRadius: 16, paddingVertical: 8, display: \"flex\", flexShrink: 1, maxWidth: Math.max(Dimensions.get(\"window\").width - 32, 300) }, getTooltipPosition(Object.assign(Object.assign({}, measurement), { idealDirection }))), (measurement.measured ? { opacity: 1 } : { opacity: 0 })), testID: \"tooltip-container\", onLayout: handleOnLayout, onPress: () => {\n                    setVisible(false);\n                } },\n                React.createElement(Text, { color: \"white\" }, text)))),\n        React.createElement(View, Object.assign({ ref: childrenWrapperRef, onPointerEnter: () => {\n                var _a, _b;\n                handleHoverIn();\n                (_b = (_a = children.props).onHoverIn) === null || _b === void 0 ? void 0 : _b.call(_a);\n            }, onPointerLeave: () => {\n                var _a, _b;\n                handleHoverOut();\n                (_b = (_a = children.props).onHoverOut) === null || _b === void 0 ? void 0 : _b.call(_a);\n            }, onTouchStart: handleTouchStart }, (!isWeb && mobilePressProps)), children)));\n};\n//# sourceMappingURL=Tooltip.js.map"]},"metadata":{},"sourceType":"module"}