{"ast":null,"code":"'use strict';import{defineAnimation,getReduceMotionForAnimation,recognizePrefixSuffix}from'./util';var _worklet_14567291833548_init_data={code:\"function anonymous(config,_animationToClamp){const{defineAnimation,recognizePrefixSuffix,getReduceMotionForAnimation}=this.__closure;return defineAnimation(_animationToClamp,function(){'worklet';const animationToClamp=typeof _animationToClamp==='function'?_animationToClamp():_animationToClamp;const strippedMin=config.min===undefined?undefined:recognizePrefixSuffix(config.min).strippedValue;const strippedMax=config.max===undefined?undefined:recognizePrefixSuffix(config.max).strippedValue;function clampOnFrame(animation,now){const finished=animationToClamp.onFrame(animationToClamp,now);if(animationToClamp.current===undefined){console.warn(\\\"[Reanimated] Error inside 'withClamp' animation, the inner animation has invalid current value\\\");return true;}else{const{prefix:prefix,strippedValue:strippedValue,suffix:suffix}=recognizePrefixSuffix(animationToClamp.current);let newValue;if(strippedMax!==undefined&&strippedMax<strippedValue){newValue=strippedMax;}else if(strippedMin!==undefined&&strippedMin>strippedValue){newValue=strippedMin;}else{newValue=strippedValue;}animation.current=typeof animationToClamp.current==='number'?newValue:\\\"\\\"+(prefix===undefined?'':prefix)+newValue+(suffix===undefined?'':suffix);}return finished;}function onStart(animation,value,now,previousAnimation){animation.current=value;animation.previousAnimation=animationToClamp;const animationBeforeClamped=previousAnimation===null||previousAnimation===void 0?void 0:previousAnimation.previousAnimation;if(config.max!==undefined&&config.min!==undefined&&config.max<config.min){console.warn('[Reanimated] Wrong config was provided to withClamp. Min value is bigger than max');}animationToClamp.onStart(animationToClamp,(animationBeforeClamped===null||animationBeforeClamped===void 0?void 0:animationBeforeClamped.current)||value,now,animationBeforeClamped);}const callback=function(finished){if(animationToClamp.callback){animationToClamp.callback(finished);}};return{isHigherOrder:true,onFrame:clampOnFrame,onStart:onStart,current:animationToClamp.current,callback:callback,previousAnimation:null,reduceMotion:getReduceMotionForAnimation(config.reduceMotion)};});}\"};var _worklet_3415995810451_init_data={code:\"function anonymous(){const{_animationToClamp,config,recognizePrefixSuffix,getReduceMotionForAnimation}=this.__closure;const animationToClamp=typeof _animationToClamp==='function'?_animationToClamp():_animationToClamp;const strippedMin=config.min===undefined?undefined:recognizePrefixSuffix(config.min).strippedValue;const strippedMax=config.max===undefined?undefined:recognizePrefixSuffix(config.max).strippedValue;function clampOnFrame(animation,now){const finished=animationToClamp.onFrame(animationToClamp,now);if(animationToClamp.current===undefined){console.warn(\\\"[Reanimated] Error inside 'withClamp' animation, the inner animation has invalid current value\\\");return true;}else{const{prefix:prefix,strippedValue:strippedValue,suffix:suffix}=recognizePrefixSuffix(animationToClamp.current);let newValue;if(strippedMax!==undefined&&strippedMax<strippedValue){newValue=strippedMax;}else if(strippedMin!==undefined&&strippedMin>strippedValue){newValue=strippedMin;}else{newValue=strippedValue;}animation.current=typeof animationToClamp.current==='number'?newValue:\\\"\\\"+(prefix===undefined?'':prefix)+newValue+(suffix===undefined?'':suffix);}return finished;}function onStart(animation,value,now,previousAnimation){animation.current=value;animation.previousAnimation=animationToClamp;const animationBeforeClamped=previousAnimation===null||previousAnimation===void 0?void 0:previousAnimation.previousAnimation;if(config.max!==undefined&&config.min!==undefined&&config.max<config.min){console.warn('[Reanimated] Wrong config was provided to withClamp. Min value is bigger than max');}animationToClamp.onStart(animationToClamp,(animationBeforeClamped===null||animationBeforeClamped===void 0?void 0:animationBeforeClamped.current)||value,now,animationBeforeClamped);}const callback=function(finished){if(animationToClamp.callback){animationToClamp.callback(finished);}};return{isHigherOrder:true,onFrame:clampOnFrame,onStart:onStart,current:animationToClamp.current,callback:callback,previousAnimation:null,reduceMotion:getReduceMotionForAnimation(config.reduceMotion)};}\"};export var withClamp=function(){var anonymous=function anonymous(config,_animationToClamp){return defineAnimation(_animationToClamp,function(){var anonymous=function anonymous(){var animationToClamp=typeof _animationToClamp==='function'?_animationToClamp():_animationToClamp;var strippedMin=config.min===undefined?undefined:recognizePrefixSuffix(config.min).strippedValue;var strippedMax=config.max===undefined?undefined:recognizePrefixSuffix(config.max).strippedValue;function clampOnFrame(animation,now){var finished=animationToClamp.onFrame(animationToClamp,now);if(animationToClamp.current===undefined){console.warn(\"[Reanimated] Error inside 'withClamp' animation, the inner animation has invalid current value\");return true;}else{var _recognizePrefixSuffi=recognizePrefixSuffix(animationToClamp.current),prefix=_recognizePrefixSuffi.prefix,strippedValue=_recognizePrefixSuffi.strippedValue,suffix=_recognizePrefixSuffi.suffix;var newValue;if(strippedMax!==undefined&&strippedMax<strippedValue){newValue=strippedMax;}else if(strippedMin!==undefined&&strippedMin>strippedValue){newValue=strippedMin;}else{newValue=strippedValue;}animation.current=typeof animationToClamp.current==='number'?newValue:`${prefix===undefined?'':prefix}${newValue}${suffix===undefined?'':suffix}`;}return finished;}function onStart(animation,value,now,previousAnimation){animation.current=value;animation.previousAnimation=animationToClamp;var animationBeforeClamped=previousAnimation===null||previousAnimation===void 0?void 0:previousAnimation.previousAnimation;if(config.max!==undefined&&config.min!==undefined&&config.max<config.min){console.warn('[Reanimated] Wrong config was provided to withClamp. Min value is bigger than max');}animationToClamp.onStart(animationToClamp,(animationBeforeClamped===null||animationBeforeClamped===void 0?void 0:animationBeforeClamped.current)||value,now,animationBeforeClamped);}var callback=function callback(finished){if(animationToClamp.callback){animationToClamp.callback(finished);}};return{isHigherOrder:true,onFrame:clampOnFrame,onStart:onStart,current:animationToClamp.current,callback:callback,previousAnimation:null,reduceMotion:getReduceMotionForAnimation(config.reduceMotion)};};anonymous.__closure={_animationToClamp:_animationToClamp,config:config,recognizePrefixSuffix:recognizePrefixSuffix,getReduceMotionForAnimation:getReduceMotionForAnimation};anonymous.__workletHash=3415995810451;anonymous.__initData=_worklet_3415995810451_init_data;return anonymous;}());};anonymous.__closure={defineAnimation:defineAnimation,recognizePrefixSuffix:recognizePrefixSuffix,getReduceMotionForAnimation:getReduceMotionForAnimation};anonymous.__workletHash=14567291833548;anonymous.__initData=_worklet_14567291833548_init_data;return anonymous;}();","map":{"version":3,"sources":["clamp.ts"],"names":["defineAnimation","getReduceMotionForAnimation","recognizePrefixSuffix","withClamp","config","_animationToClamp","animationToClamp","strippedMin","min","undefined","strippedValue","strippedMax","max","clampOnFrame","animation","now","finished","onFrame","current","console","warn","prefix","suffix","newValue","onStart","value","previousAnimation","animationBeforeClamped","callback","isHigherOrder","reduceMotion"],"mappings":"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","sourcesContent":["'use strict';\nimport {\n  defineAnimation,\n  getReduceMotionForAnimation,\n  recognizePrefixSuffix,\n} from './util';\nimport type {\n  Animation,\n  Timestamp,\n  AnimatableValue,\n  AnimationObject,\n  ReduceMotion,\n} from '../commonTypes';\nimport type { ClampAnimation } from './commonTypes';\n\ntype withClampType = <T extends number | string>(\n  config: {\n    min?: T;\n    max?: T;\n  },\n  clampedAnimation: T\n) => T;\n\nexport const withClamp = function <T extends number | string>(\n  config: { min?: T; max?: T; reduceMotion?: ReduceMotion },\n  _animationToClamp: AnimationObject<T> | (() => AnimationObject<T>)\n): Animation<ClampAnimation> {\n  'worklet';\n  return defineAnimation<ClampAnimation, AnimationObject<T>>(\n    _animationToClamp,\n    (): ClampAnimation => {\n      'worklet';\n      const animationToClamp =\n        typeof _animationToClamp === 'function'\n          ? _animationToClamp()\n          : _animationToClamp;\n\n      const strippedMin =\n        config.min === undefined\n          ? undefined\n          : recognizePrefixSuffix(config.min).strippedValue;\n\n      const strippedMax =\n        config.max === undefined\n          ? undefined\n          : recognizePrefixSuffix(config.max).strippedValue;\n\n      function clampOnFrame(\n        animation: ClampAnimation,\n        now: Timestamp\n      ): boolean {\n        const finished = animationToClamp.onFrame(animationToClamp, now);\n\n        if (animationToClamp.current === undefined) {\n          console.warn(\n            \"[Reanimated] Error inside 'withClamp' animation, the inner animation has invalid current value\"\n          );\n          return true;\n        } else {\n          const { prefix, strippedValue, suffix } = recognizePrefixSuffix(\n            animationToClamp.current\n          );\n\n          let newValue;\n\n          if (strippedMax !== undefined && strippedMax < strippedValue) {\n            newValue = strippedMax;\n          } else if (strippedMin !== undefined && strippedMin > strippedValue) {\n            newValue = strippedMin;\n          } else {\n            newValue = strippedValue;\n          }\n\n          animation.current =\n            typeof animationToClamp.current === 'number'\n              ? (newValue as number)\n              : `${prefix === undefined ? '' : prefix}${newValue}${\n                  suffix === undefined ? '' : suffix\n                }`;\n        }\n\n        return finished;\n      }\n\n      function onStart(\n        animation: Animation<any>,\n        value: AnimatableValue,\n        now: Timestamp,\n        previousAnimation: Animation<any> | null\n      ): void {\n        animation.current = value;\n        animation.previousAnimation = animationToClamp;\n        const animationBeforeClamped = previousAnimation?.previousAnimation;\n        if (\n          config.max !== undefined &&\n          config.min !== undefined &&\n          config.max < config.min\n        ) {\n          console.warn(\n            '[Reanimated] Wrong config was provided to withClamp. Min value is bigger than max'\n          );\n        }\n\n        animationToClamp.onStart(\n          animationToClamp,\n          /** provide the current value of the previous animation of the clamped animation \n          so we can animate from the original \"un-truncated\" value\n          */\n          animationBeforeClamped?.current || value,\n          now,\n          animationBeforeClamped\n        );\n      }\n\n      const callback = (finished?: boolean): void => {\n        if (animationToClamp.callback) {\n          animationToClamp.callback(finished);\n        }\n      };\n\n      return {\n        isHigherOrder: true,\n        onFrame: clampOnFrame,\n        onStart,\n        current: animationToClamp.current!,\n        callback,\n        previousAnimation: null,\n        reduceMotion: getReduceMotionForAnimation(config.reduceMotion),\n      };\n    }\n  );\n} as withClampType;\n"]},"metadata":{},"sourceType":"module"}