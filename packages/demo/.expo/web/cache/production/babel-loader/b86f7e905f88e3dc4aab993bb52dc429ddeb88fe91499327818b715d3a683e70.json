{"ast":null,"code":"'use strict';import{Animations,customAnimations}from'./config';var WEB_ANIMATIONS_ID='ReanimatedWebAnimationsStyle';export function configureWebLayoutAnimations(){if(document.getElementById(WEB_ANIMATIONS_ID)!==null){return;}var style=document.createElement('style');style.id=WEB_ANIMATIONS_ID;style.onload=function(){if(!style.sheet){console.error('[Reanimated] Failed to create layout animations stylesheet');return;}for(var animationName in Animations){style.sheet.insertRule(Animations[animationName].style);}};document.head.appendChild(style);}export function insertWebAnimation(animationName,keyframe){var styleTag=document.getElementById(WEB_ANIMATIONS_ID);if(!styleTag.sheet){console.error('[Reanimated] Failed to create layout animations stylesheet');return;}var customTransitionId=styleTag.sheet.insertRule(keyframe);customAnimations.set(animationName,customTransitionId);}function removeWebAnimation(animationName){var _styleTag$sheet;if(!customAnimations.has(animationName)){return;}var styleTag=document.getElementById(WEB_ANIMATIONS_ID);(_styleTag$sheet=styleTag.sheet)===null||_styleTag$sheet===void 0?void 0:_styleTag$sheet.deleteRule(customAnimations.get(animationName));customAnimations.delete(animationName);}var timeoutScale=1.25;var frameDurationMs=16;var minimumFrames=10;export function scheduleAnimationCleanup(animationName,animationDuration){var timeoutValue=Math.max(animationDuration*timeoutScale*1000,animationDuration+frameDurationMs*minimumFrames);setTimeout(function(){return removeWebAnimation(animationName);},timeoutValue);}export function areDOMRectsEqual(r1,r2){return r1.x===r2.x&&r1.y===r2.y&&r1.width===r2.width&&r1.height===r2.height;}","map":{"version":3,"names":["Animations","customAnimations","WEB_ANIMATIONS_ID","configureWebLayoutAnimations","document","getElementById","style","createElement","id","onload","sheet","console","error","animationName","insertRule","head","appendChild","insertWebAnimation","keyframe","styleTag","customTransitionId","set","removeWebAnimation","_styleTag$sheet","has","deleteRule","get","delete","timeoutScale","frameDurationMs","minimumFrames","scheduleAnimationCleanup","animationDuration","timeoutValue","Math","max","setTimeout","areDOMRectsEqual","r1","r2","x","y","width","height"],"sources":["/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/web/domUtils.ts"],"sourcesContent":["'use strict';\n\nimport { Animations, customAnimations } from './config';\nimport type { AnimationNames } from './config';\n\nconst WEB_ANIMATIONS_ID = 'ReanimatedWebAnimationsStyle';\n\n/**\n *  Creates `HTMLStyleElement`, inserts it into DOM and then inserts CSS rules into the stylesheet.\n *  If style element already exists, nothing happens.\n */\nexport function configureWebLayoutAnimations() {\n  if (document.getElementById(WEB_ANIMATIONS_ID) !== null) {\n    return;\n  }\n\n  const style = document.createElement('style');\n  style.id = WEB_ANIMATIONS_ID;\n\n  style.onload = () => {\n    if (!style.sheet) {\n      console.error(\n        '[Reanimated] Failed to create layout animations stylesheet'\n      );\n      return;\n    }\n\n    for (const animationName in Animations) {\n      style.sheet.insertRule(Animations[animationName as AnimationNames].style);\n    }\n  };\n\n  document.head.appendChild(style);\n}\n\nexport function insertWebAnimation(animationName: string, keyframe: string) {\n  const styleTag = document.getElementById(\n    WEB_ANIMATIONS_ID\n  ) as HTMLStyleElement;\n\n  if (!styleTag.sheet) {\n    console.error('[Reanimated] Failed to create layout animations stylesheet');\n    return;\n  }\n\n  const customTransitionId = styleTag.sheet.insertRule(keyframe);\n  customAnimations.set(animationName, customTransitionId);\n}\n\nfunction removeWebAnimation(animationName: string) {\n  if (!customAnimations.has(animationName)) {\n    return;\n  }\n\n  const styleTag = document.getElementById(\n    WEB_ANIMATIONS_ID\n  ) as HTMLStyleElement;\n\n  styleTag.sheet?.deleteRule(customAnimations.get(animationName) as number);\n  customAnimations.delete(animationName);\n}\n\nconst timeoutScale = 1.25; // We use this value to enlarge timeout duration. It can prove useful if animation lags.\nconst frameDurationMs = 16; // Just an approximation.\nconst minimumFrames = 10;\n\nexport function scheduleAnimationCleanup(\n  animationName: string,\n  animationDuration: number\n) {\n  // If duration is very short, we want to keep remove delay to at least 10 frames\n  // In our case it is exactly 160/1099 s, which is approximately 0.15s\n  const timeoutValue = Math.max(\n    animationDuration * timeoutScale * 1000,\n    animationDuration + frameDurationMs * minimumFrames\n  );\n\n  setTimeout(() => removeWebAnimation(animationName), timeoutValue);\n}\n\nexport function areDOMRectsEqual(r1: DOMRect, r2: DOMRect) {\n  // There are 4 more fields, but checking these should suffice\n  return (\n    r1.x === r2.x &&\n    r1.y === r2.y &&\n    r1.width === r2.width &&\n    r1.height === r2.height\n  );\n}\n"],"mappings":"AAAA,YAAY,CAEZ,OAASA,UAAU,CAAEC,gBAAgB,KAAQ,UAAU,CAGvD,GAAM,CAAAC,iBAAiB,CAAG,8BAA8B,CAMxD,MAAO,SAAS,CAAAC,4BAA4BA,CAAA,CAAG,CAC7C,GAAIC,QAAQ,CAACC,cAAc,CAACH,iBAAiB,CAAC,GAAK,IAAI,CAAE,CACvD,OACF,CAEA,GAAM,CAAAI,KAAK,CAAGF,QAAQ,CAACG,aAAa,CAAC,OAAO,CAAC,CAC7CD,KAAK,CAACE,EAAE,CAAGN,iBAAiB,CAE5BI,KAAK,CAACG,MAAM,CAAG,UAAM,CACnB,GAAI,CAACH,KAAK,CAACI,KAAK,CAAE,CAChBC,OAAO,CAACC,KAAK,CACX,4DAA4D,CAC7D,CACD,OACF,CAEA,IAAK,GAAM,CAAAC,aAAa,GAAI,CAAAb,UAAU,CAAE,CACtCM,KAAK,CAACI,KAAK,CAACI,UAAU,CAACd,UAAU,CAACa,aAAa,CAAmB,CAACP,KAAK,CAAC,CAC3E,CACF,CAAC,CAEDF,QAAQ,CAACW,IAAI,CAACC,WAAW,CAACV,KAAK,CAAC,CAClC,CAEA,MAAO,SAAS,CAAAW,kBAAkBA,CAACJ,aAAqB,CAAEK,QAAgB,CAAE,CAC1E,GAAM,CAAAC,QAAQ,CAAGf,QAAQ,CAACC,cAAc,CACtCH,iBAAiB,CACE,CAErB,GAAI,CAACiB,QAAQ,CAACT,KAAK,CAAE,CACnBC,OAAO,CAACC,KAAK,CAAC,4DAA4D,CAAC,CAC3E,OACF,CAEA,GAAM,CAAAQ,kBAAkB,CAAGD,QAAQ,CAACT,KAAK,CAACI,UAAU,CAACI,QAAQ,CAAC,CAC9DjB,gBAAgB,CAACoB,GAAG,CAACR,aAAa,CAAEO,kBAAkB,CAAC,CACzD,CAEA,QAAS,CAAAE,kBAAkBA,CAACT,aAAqB,CAAE,KAAAU,eAAA,CACjD,GAAI,CAACtB,gBAAgB,CAACuB,GAAG,CAACX,aAAa,CAAC,CAAE,CACxC,OACF,CAEA,GAAM,CAAAM,QAAQ,CAAGf,QAAQ,CAACC,cAAc,CACtCH,iBAAiB,CACE,CAErB,CAAAqB,eAAA,CAAAJ,QAAQ,CAACT,KAAK,UAAAa,eAAA,iBAAdA,eAAA,CAAgBE,UAAU,CAACxB,gBAAgB,CAACyB,GAAG,CAACb,aAAa,CAAC,CAAW,CACzEZ,gBAAgB,CAAC0B,MAAM,CAACd,aAAa,CAAC,CACxC,CAEA,GAAM,CAAAe,YAAY,CAAG,IAAI,CACzB,GAAM,CAAAC,eAAe,CAAG,EAAE,CAC1B,GAAM,CAAAC,aAAa,CAAG,EAAE,CAExB,MAAO,SAAS,CAAAC,wBAAwBA,CACtClB,aAAqB,CACrBmB,iBAAyB,CACzB,CAGA,GAAM,CAAAC,YAAY,CAAGC,IAAI,CAACC,GAAG,CAC3BH,iBAAiB,CAAGJ,YAAY,CAAG,IAAI,CACvCI,iBAAiB,CAAGH,eAAe,CAAGC,aAAa,CACpD,CAEDM,UAAU,CAAC,iBAAM,CAAAd,kBAAkB,CAACT,aAAa,CAAC,GAAEoB,YAAY,CAAC,CACnE,CAEA,MAAO,SAAS,CAAAI,gBAAgBA,CAACC,EAAW,CAAEC,EAAW,CAAE,CAEzD,MACE,CAAAD,EAAE,CAACE,CAAC,GAAKD,EAAE,CAACC,CAAC,EACbF,EAAE,CAACG,CAAC,GAAKF,EAAE,CAACE,CAAC,EACbH,EAAE,CAACI,KAAK,GAAKH,EAAE,CAACG,KAAK,EACrBJ,EAAE,CAACK,MAAM,GAAKJ,EAAE,CAACI,MAAM,CAE3B"},"metadata":{},"sourceType":"module","externalDependencies":[]}