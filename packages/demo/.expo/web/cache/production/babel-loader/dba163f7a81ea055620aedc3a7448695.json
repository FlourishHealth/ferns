{"ast":null,"code":"'use strict';import{defineAnimation,getReduceMotionForAnimation}from'../util';import{rubberBandDecay}from'./rubberBandDecay';import{isValidRubberBandConfig}from'./utils';import{rigidDecay}from'./rigidDecay';var _worklet_10880719511297_init_data={code:\"function validateConfig(config){if(config.clamp){if(!Array.isArray(config.clamp)){throw new Error(\\\"[Reanimated] `config.clamp` must be an array but is \\\"+typeof config.clamp+\\\".\\\");}if(config.clamp.length!==2){throw new Error(\\\"[Reanimated] `clamp array` must contain 2 items but is given \\\"+config.clamp.length+\\\".\\\");}}if(config.velocityFactor<=0){throw new Error(\\\"[Reanimated] `config.velocityFactor` must be greather then 0 but is \\\"+config.velocityFactor+\\\".\\\");}if(config.rubberBandEffect&&!config.clamp){throw new Error('[Reanimated] You need to set `clamp` property when using `rubberBandEffect`.');}}\"};var validateConfig=function(){var validateConfig=function validateConfig(config){if(config.clamp){if(!Array.isArray(config.clamp)){throw new Error(`[Reanimated] \\`config.clamp\\` must be an array but is ${typeof config.clamp}.`);}if(config.clamp.length!==2){throw new Error(`[Reanimated] \\`clamp array\\` must contain 2 items but is given ${config.clamp.length}.`);}}if(config.velocityFactor<=0){throw new Error(`[Reanimated] \\`config.velocityFactor\\` must be greather then 0 but is ${config.velocityFactor}.`);}if(config.rubberBandEffect&&!config.clamp){throw new Error('[Reanimated] You need to set `clamp` property when using `rubberBandEffect`.');}};validateConfig.__closure={};validateConfig.__workletHash=10880719511297;validateConfig.__initData=_worklet_10880719511297_init_data;return validateConfig;}();var _worklet_12854220298_init_data={code:\"function anonymous(userConfig,callback){const{defineAnimation,isValidRubberBandConfig,rubberBandDecay,rigidDecay,validateConfig,getReduceMotionForAnimation}=this.__closure;return defineAnimation(0,function(){'worklet';var _config$velocity;const config={deceleration:0.998,velocityFactor:1,velocity:0,rubberBandFactor:0.6};if(userConfig){Object.keys(userConfig).forEach(function(key){return config[key]=userConfig[key];});}const decay=isValidRubberBandConfig(config)?function(animation,now){return rubberBandDecay(animation,now,config);}:function(animation,now){return rigidDecay(animation,now,config);};function onStart(animation,value,now){animation.current=value;animation.lastTimestamp=now;animation.startTimestamp=now;animation.initialVelocity=config.velocity;validateConfig(config);if(animation.reduceMotion&&config.clamp){if(value<config.clamp[0]){animation.current=config.clamp[0];}else if(value>config.clamp[1]){animation.current=config.clamp[1];}}}return{onFrame:decay,onStart:onStart,callback:callback,velocity:(_config$velocity=config.velocity)!==null&&_config$velocity!==void 0?_config$velocity:0,initialVelocity:0,current:0,lastTimestamp:0,startTimestamp:0,reduceMotion:getReduceMotionForAnimation(config.reduceMotion)};});}\"};var _worklet_3982720953188_init_data={code:\"function anonymous(){const{userConfig,isValidRubberBandConfig,rubberBandDecay,rigidDecay,validateConfig,callback,getReduceMotionForAnimation}=this.__closure;var _config$velocity;const config={deceleration:0.998,velocityFactor:1,velocity:0,rubberBandFactor:0.6};if(userConfig){Object.keys(userConfig).forEach(function(key){return config[key]=userConfig[key];});}const decay=isValidRubberBandConfig(config)?function(animation,now){return rubberBandDecay(animation,now,config);}:function(animation,now){return rigidDecay(animation,now,config);};function onStart(animation,value,now){animation.current=value;animation.lastTimestamp=now;animation.startTimestamp=now;animation.initialVelocity=config.velocity;validateConfig(config);if(animation.reduceMotion&&config.clamp){if(value<config.clamp[0]){animation.current=config.clamp[0];}else if(value>config.clamp[1]){animation.current=config.clamp[1];}}}return{onFrame:decay,onStart:onStart,callback:callback,velocity:(_config$velocity=config.velocity)!==null&&_config$velocity!==void 0?_config$velocity:0,initialVelocity:0,current:0,lastTimestamp:0,startTimestamp:0,reduceMotion:getReduceMotionForAnimation(config.reduceMotion)};}\"};export var withDecay=function(){var anonymous=function anonymous(userConfig,callback){return defineAnimation(0,function(){var anonymous=function anonymous(){var _config$velocity;var config={deceleration:0.998,velocityFactor:1,velocity:0,rubberBandFactor:0.6};if(userConfig){Object.keys(userConfig).forEach(function(key){return config[key]=userConfig[key];});}var decay=isValidRubberBandConfig(config)?function(animation,now){return rubberBandDecay(animation,now,config);}:function(animation,now){return rigidDecay(animation,now,config);};function onStart(animation,value,now){animation.current=value;animation.lastTimestamp=now;animation.startTimestamp=now;animation.initialVelocity=config.velocity;validateConfig(config);if(animation.reduceMotion&&config.clamp){if(value<config.clamp[0]){animation.current=config.clamp[0];}else if(value>config.clamp[1]){animation.current=config.clamp[1];}}}return{onFrame:decay,onStart:onStart,callback:callback,velocity:(_config$velocity=config.velocity)!=null?_config$velocity:0,initialVelocity:0,current:0,lastTimestamp:0,startTimestamp:0,reduceMotion:getReduceMotionForAnimation(config.reduceMotion)};};anonymous.__closure={userConfig:userConfig,isValidRubberBandConfig:isValidRubberBandConfig,rubberBandDecay:rubberBandDecay,rigidDecay:rigidDecay,validateConfig:validateConfig,callback:callback,getReduceMotionForAnimation:getReduceMotionForAnimation};anonymous.__workletHash=3982720953188;anonymous.__initData=_worklet_3982720953188_init_data;return anonymous;}());};anonymous.__closure={defineAnimation:defineAnimation,isValidRubberBandConfig:isValidRubberBandConfig,rubberBandDecay:rubberBandDecay,rigidDecay:rigidDecay,validateConfig:validateConfig,getReduceMotionForAnimation:getReduceMotionForAnimation};anonymous.__workletHash=12854220298;anonymous.__initData=_worklet_12854220298_init_data;return anonymous;}();","map":{"version":3,"sources":["decay.ts"],"names":["defineAnimation","getReduceMotionForAnimation","rubberBandDecay","isValidRubberBandConfig","rigidDecay","validateConfig","config","clamp","Array","isArray","Error","length","velocityFactor","rubberBandEffect","withDecay","userConfig","callback","deceleration","velocity","rubberBandFactor","Object","keys","forEach","key","decay","animation","now","onStart","value","current","lastTimestamp","startTimestamp","initialVelocity","reduceMotion","onFrame"],"mappings":"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","sourcesContent":["'use strict';\nimport { defineAnimation, getReduceMotionForAnimation } from '../util';\nimport type {\n  AnimationCallback,\n  Timestamp,\n  Animation,\n} from '../../commonTypes';\nimport { rubberBandDecay } from './rubberBandDecay';\nimport { isValidRubberBandConfig } from './utils';\nimport type {\n  DecayAnimation,\n  DecayConfig,\n  DefaultDecayConfig,\n  InnerDecayAnimation,\n} from './utils';\nimport { rigidDecay } from './rigidDecay';\n\nexport type WithDecayConfig = DecayConfig;\n\n// TODO TYPESCRIPT This is a temporary type to get rid of .d.ts file.\ntype withDecayType = (\n  userConfig: DecayConfig,\n  callback?: AnimationCallback\n) => number;\n\nfunction validateConfig(config: DefaultDecayConfig): void {\n  'worklet';\n  if (config.clamp) {\n    if (!Array.isArray(config.clamp)) {\n      throw new Error(\n        `[Reanimated] \\`config.clamp\\` must be an array but is ${typeof config.clamp}.`\n      );\n    }\n    if (config.clamp.length !== 2) {\n      throw new Error(\n        `[Reanimated] \\`clamp array\\` must contain 2 items but is given ${config.clamp.length}.`\n      );\n    }\n  }\n  if (config.velocityFactor <= 0) {\n    throw new Error(\n      `[Reanimated] \\`config.velocityFactor\\` must be greather then 0 but is ${config.velocityFactor}.`\n    );\n  }\n  if (config.rubberBandEffect && !config.clamp) {\n    throw new Error(\n      '[Reanimated] You need to set `clamp` property when using `rubberBandEffect`.'\n    );\n  }\n}\n\n/**\n * Lets you create animations that mimic objects in motion with friction.\n *\n * @param config - The decay animation configuration - {@link DecayConfig}.\n * @param callback - A function called upon animation completion - {@link AnimationCallback}.\n * @returns An [animation object](https://docs.swmansion.com/react-native-reanimated/docs/fundamentals/glossary#animation-object) which holds the current state of the animation.\n * @see https://docs.swmansion.com/react-native-reanimated/docs/animations/withDecay\n */\nexport const withDecay = function (\n  userConfig: DecayConfig,\n  callback?: AnimationCallback\n): Animation<DecayAnimation> {\n  'worklet';\n\n  return defineAnimation<DecayAnimation>(0, () => {\n    'worklet';\n    const config: DefaultDecayConfig = {\n      deceleration: 0.998,\n      velocityFactor: 1,\n      velocity: 0,\n      rubberBandFactor: 0.6,\n    };\n    if (userConfig) {\n      Object.keys(userConfig).forEach(\n        (key) =>\n          ((config as any)[key] = userConfig[key as keyof typeof userConfig])\n      );\n    }\n\n    const decay: (animation: InnerDecayAnimation, now: number) => boolean =\n      isValidRubberBandConfig(config)\n        ? (animation, now) => rubberBandDecay(animation, now, config)\n        : (animation, now) => rigidDecay(animation, now, config);\n\n    function onStart(\n      animation: DecayAnimation,\n      value: number,\n      now: Timestamp\n    ): void {\n      animation.current = value;\n      animation.lastTimestamp = now;\n      animation.startTimestamp = now;\n      animation.initialVelocity = config.velocity;\n      validateConfig(config);\n\n      if (animation.reduceMotion && config.clamp) {\n        if (value < config.clamp[0]) {\n          animation.current = config.clamp[0];\n        } else if (value > config.clamp[1]) {\n          animation.current = config.clamp[1];\n        }\n      }\n    }\n\n    return {\n      onFrame: decay,\n      onStart,\n      callback,\n      velocity: config.velocity ?? 0,\n      initialVelocity: 0,\n      current: 0,\n      lastTimestamp: 0,\n      startTimestamp: 0,\n      reduceMotion: getReduceMotionForAnimation(config.reduceMotion),\n    } as DecayAnimation;\n  });\n} as unknown as withDecayType;\n"]},"metadata":{},"sourceType":"module"}