{"ast":null,"code":"'use strict';import{useRef}from'react';import{useSharedValue}from'./useSharedValue';import{getShadowNodeWrapperFromRef}from'../fabricUtils';import{makeShareableCloneRecursive,registerShareableMapping}from'../shareables';import Platform from\"react-native-web/dist/exports/Platform\";import findNodeHandle from\"react-native-web/dist/exports/findNodeHandle\";import{isFabric}from'../PlatformChecker';var IS_FABRIC=isFabric();function getComponentOrScrollable(component){if(IS_FABRIC&&component.getNativeScrollRef){return component.getNativeScrollRef();}else if(!IS_FABRIC&&component.getScrollableNode){return component.getScrollableNode();}return component;}var getTagValueFunction=IS_FABRIC?getShadowNodeWrapperFromRef:findNodeHandle;var _worklet_10709902486534_init_data={code:\"function anonymous(){const{tag,viewName}=this.__closure;const f=function(){return tag.value;};f.viewName=viewName;return f;}\"};export function useAnimatedRef(){var tag=useSharedValue(-1);var viewName=useSharedValue(null);var ref=useRef();if(!ref.current){var fun=function fun(component){if(component){tag.value=getTagValueFunction(getComponentOrScrollable(component));fun.current=component;if(\"web\"==='ios'&&!IS_FABRIC){var _viewConfig;viewName.value=(component===null||component===void 0?void 0:(_viewConfig=component.viewConfig)===null||_viewConfig===void 0?void 0:_viewConfig.uiViewClassName)||'RCTView';}}return tag.value;};fun.current=null;var remoteRef=makeShareableCloneRecursive({__init:function(){var anonymous=function anonymous(){var f=function f(){return tag.value;};f.viewName=viewName;return f;};anonymous.__closure={tag:tag,viewName:viewName};anonymous.__workletHash=10709902486534;anonymous.__initData=_worklet_10709902486534_init_data;return anonymous;}()});registerShareableMapping(fun,remoteRef);ref.current=fun;}return ref.current;}","map":{"version":3,"sources":["useAnimatedRef.ts"],"names":["useRef","useSharedValue","getShadowNodeWrapperFromRef","makeShareableCloneRecursive","registerShareableMapping","isFabric","IS_FABRIC","getComponentOrScrollable","component","getNativeScrollRef","getScrollableNode","getTagValueFunction","findNodeHandle","useAnimatedRef","tag","viewName","ref","current","fun","value","Platform","viewConfig","uiViewClassName","remoteRef","__init","f"],"mappings":"AAAA,YAAY,CAEZ,OAASA,MAAM,KAAQ,OAAO,CAC9B,OAASC,cAAc,KAAQ,kBAAkB,CAGjD,OAASC,2BAA2B,KAAQ,gBAAgB,CAC5D,OACEC,2BAA2B,CAC3BC,wBAAwB,KACnB,eAAe,CAAA,OAAA,QAAA,qDAAA,cAAA,oDAEtB,OAASC,QAAQ,KAAQ,oBAAoB,CAE7C,GAAMC,CAAAA,SAAS,CAAGD,QAAQ,CAAA,CAAE,CAY5B,QAASE,CAAAA,wBAAwBA,CAACC,SAAmC,CAAE,CACrE,GAAIF,SAAS,EAAIE,SAAS,CAACC,kBAAkB,CAAE,CAC7C,MAAOD,CAAAA,SAAS,CAACC,kBAAkB,CAAA,CAAE,CACvC,CAAC,IAAM,IAAI,CAACH,SAAS,EAAIE,SAAS,CAACE,iBAAiB,CAAE,CACpD,MAAOF,CAAAA,SAAS,CAACE,iBAAiB,CAAA,CAAE,CACtC,CACA,MAAOF,CAAAA,SAAS,CAClB,CAEA,GAAMG,CAAAA,mBAAmB,CAAGL,SAAS,CACjCJ,2BAA2B,CAC3BU,cAAc,CAAA,IAAA,iCAAA,EAAA,IAAA,iIAQlB,MAAO,SAASC,CAAAA,cAAcA,CAAAA,CAED,CAC3B,GAAMC,CAAAA,GAAG,CAAGb,cAAc,CAAoC,CAAC,CAAC,CAAC,CACjE,GAAMc,CAAAA,QAAQ,CAAGd,cAAc,CAAgB,IAAI,CAAC,CAEpD,GAAMe,CAAAA,GAAG,CAAGhB,MAAM,CAAA,CAA2B,CAE7C,GAAI,CAACgB,GAAG,CAACC,OAAO,CAAE,CAChB,GAAMC,CAAAA,GAA4B,CAChCV,QADIU,CAAAA,GAA4B,CAChCV,SAAS,CACN,CAEH,GAAIA,SAAS,CAAE,CACbM,GAAG,CAACK,KAAK,CAAGR,mBAAmB,CAACJ,wBAAwB,CAACC,SAAS,CAAC,CAAC,CACpEU,GAAG,CAACD,OAAO,CAAGT,SAAS,CAEvB,GAAIY,QAAgB,KAAK,EAAI,CAACd,SAAS,CAAE,CAAA,GAAA,CAAA,WAAA,CACvCS,QAAQ,CAACI,KAAK,CACZ,CAACX,SAAS,GAAA,IAAA,EAATA,SAAS,GAAA,IAAA,EAAA,CAAA,IAAA,EAAA,CAAA,CAAA,WAAA,CAATA,SAAS,CAA+Ba,UAAU,IAAA,IAAA,EAAA,WAAA,GAAA,IAAA,EAAA,CAAA,IAAA,EAAA,CAAnD,WAAA,CACIC,eAAe,GAAI,SAAS,CACpC,CACF,CACA,MAAOR,CAAAA,GAAG,CAACK,KAAK,CAClB,CAAE,CAEFD,GAAG,CAACD,OAAO,CAAG,IAAI,CAElB,GAAMM,CAAAA,SAAS,CAAGpB,2BAA2B,CAAC,CAC5CqB,MAAM,CAAEA,eAAAA,SAAAA,UAAAA,UAAAA,CAAM,CAEZ,GAAMC,CAAAA,CAAC,CAAGA,QAAJA,CAAAA,CAAC,CAAA,QAASX,CAAAA,GAAG,CAACK,KAAK,GACzBM,CAAC,CAACV,QAAQ,CAAGA,QAAQ,CACrB,MAAOU,CAAAA,CAAC,CACV,CAAA,CAAA,SAAA,CAAA,SAAA,EAAA,GAAA,CAHkBX,GAAG,CAAA,QAAA,CACNC,QAAQ,EAAA,SAAA,CAAA,aAAA,gBAAA,SAAA,CAAA,UAAA,CAAA,iCAAA,QAAA,SAAA,EAHfS,EAMV,CAAC,CAAC,CACFpB,wBAAwB,CAACc,GAAG,CAAEK,SAAS,CAAC,CACxCP,GAAG,CAACC,OAAO,CAAGC,GAAG,CACnB,CAEA,MAAOF,CAAAA,GAAG,CAACC,OAAO,CACpB","sourcesContent":["'use strict';\nimport type { Component } from 'react';\nimport { useRef } from 'react';\nimport { useSharedValue } from './useSharedValue';\nimport type { AnimatedRef } from './commonTypes';\nimport type { ShadowNodeWrapper } from '../commonTypes';\nimport { getShadowNodeWrapperFromRef } from '../fabricUtils';\nimport {\n  makeShareableCloneRecursive,\n  registerShareableMapping,\n} from '../shareables';\nimport { Platform, findNodeHandle } from 'react-native';\nimport { isFabric } from '../PlatformChecker';\n\nconst IS_FABRIC = isFabric();\n\ninterface MaybeScrollableComponent extends Component {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  getNativeScrollRef?: any;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  getScrollableNode?: any;\n  viewConfig?: {\n    uiViewClassName?: string;\n  };\n}\n\nfunction getComponentOrScrollable(component: MaybeScrollableComponent) {\n  if (IS_FABRIC && component.getNativeScrollRef) {\n    return component.getNativeScrollRef();\n  } else if (!IS_FABRIC && component.getScrollableNode) {\n    return component.getScrollableNode();\n  }\n  return component;\n}\n\nconst getTagValueFunction = IS_FABRIC\n  ? getShadowNodeWrapperFromRef\n  : findNodeHandle;\n\n/**\n * Lets you get a reference of a view that you can use inside a worklet.\n *\n * @returns An object with a `.current` property which contains an instance of a component.\n * @see https://docs.swmansion.com/react-native-reanimated/docs/core/useAnimatedRef\n */\nexport function useAnimatedRef<\n  TComponent extends Component\n>(): AnimatedRef<TComponent> {\n  const tag = useSharedValue<number | ShadowNodeWrapper | null>(-1);\n  const viewName = useSharedValue<string | null>(null);\n\n  const ref = useRef<AnimatedRef<TComponent>>();\n\n  if (!ref.current) {\n    const fun: AnimatedRef<TComponent> = <AnimatedRef<TComponent>>((\n      component\n    ) => {\n      // enters when ref is set by attaching to a component\n      if (component) {\n        tag.value = getTagValueFunction(getComponentOrScrollable(component));\n        fun.current = component;\n        // viewName is required only on iOS with Paper\n        if (Platform.OS === 'ios' && !IS_FABRIC) {\n          viewName.value =\n            (component as MaybeScrollableComponent)?.viewConfig\n              ?.uiViewClassName || 'RCTView';\n        }\n      }\n      return tag.value;\n    });\n\n    fun.current = null;\n\n    const remoteRef = makeShareableCloneRecursive({\n      __init: () => {\n        'worklet';\n        const f = () => tag.value;\n        f.viewName = viewName;\n        return f;\n      },\n    });\n    registerShareableMapping(fun, remoteRef);\n    ref.current = fun;\n  }\n\n  return ref.current;\n}\n"]},"metadata":{},"sourceType":"module"}