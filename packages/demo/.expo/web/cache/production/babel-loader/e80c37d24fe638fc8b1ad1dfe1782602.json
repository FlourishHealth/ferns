{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import{manipulateAsync,SaveFormat}from\"expo-image-manipulator\";import{launchImageLibraryAsync,MediaTypeOptions}from\"expo-image-picker\";import React,{useContext,useEffect,useState}from\"react\";import Image from\"react-native-web/dist/exports/Image\";import Platform from\"react-native-web/dist/exports/Platform\";import Text from\"react-native-web/dist/exports/Text\";import View from\"react-native-web/dist/exports/View\";import{Box}from\"./Box\";import{Icon}from\"./Icon\";import{isMobileDevice}from\"./MediaQuery\";import{ThemeContext}from\"./Theme\";import{Tooltip}from\"./Tooltip\";var sizes={xs:24,sm:32,md:48,lg:64,xl:120};var sizeIconPadding={xs:0,sm:0,md:1,lg:1,xl:2};var statusIcons={online:{icon:\"circle\",color:\"green\",label:\"Online\"},offline:{icon:\"circle\",color:\"gray\",label:\"Offline\"},doNotDisturb:{icon:\"minus-circle\",color:\"red\",label:\"Do Not Disturb\"},away:{icon:\"moon\",color:\"orange\",label:\"Away\"},meeting:{icon:\"calendar\",color:\"orange\",label:\"In a Meeting\"},vacation:{icon:\"plane\",color:\"orange\",label:\"On Vacation\"},sick:{icon:\"clinic-medical\",color:\"orange\",label:\"Sick\"},outOfOffice:{icon:\"clock\",color:\"orange\",label:\"Out of Office\"},commuting:{icon:\"car\",color:\"orange\",label:\"Commuting\"}};export var Avatar=function Avatar(props){var _a,_b,_c;var _useContext=useContext(ThemeContext),theme=_useContext.theme;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isImageLoaded=_useState2[0],setIsImageLoaded=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),hovered=_useState4[0],setHovered=_useState4[1];var _useState5=useState((_a=props.src)!==null&&_a!==void 0?_a:undefined),_useState6=_slicedToArray(_useState5,2),src=_useState6[0],setSrc=_useState6[1];var name=props.name,initials=props.initials,outline=props.outline,_props$size=props.size,size=_props$size===void 0?\"md\":_props$size,_props$imageFit=props.imageFit,imageFit=_props$imageFit===void 0?\"contain\":_props$imageFit,editAvatarImage=props.editAvatarImage,onChange=props.onChange,_props$avatarImageWid=props.avatarImageWidth,avatarImageWidth=_props$avatarImageWid===void 0?sizes[size]:_props$avatarImageWid,avatarImageHeight=props.avatarImageHeight,_props$avatarImageFor=props.avatarImageFormat,avatarImageFormat=_props$avatarImageFor===void 0?SaveFormat.PNG:_props$avatarImageFor,_props$shouldShowEdit=props.shouldShowEditIconIfNoImage,shouldShowEditIconIfNoImage=_props$shouldShowEdit===void 0?false:_props$shouldShowEdit;var width=sizes[size];var height=sizes[size];var radius=sizes[size]/2;var fontSize=sizes[size]/2;var computedInitials=initials!==null&&initials!==void 0?initials:name.match(/(^\\S\\S?|\\s\\S)?/g).map(function(v){return v.trim();}).join(\"\").match(/(^\\S|\\S$)?/g).join(\"\").toLocaleUpperCase();useEffect(function(){setSrc(props.src);},[props]);if(editAvatarImage&&!onChange){console.warn(\"Avatars with the editAvatarImage flag on should also have an onChange property.\");}var handleImageError=function handleImageError(){setIsImageLoaded(false);console.warn(\"Image load error\");};var pickImage=function(){var _ref=_asyncToGenerator(function*(){var result=yield launchImageLibraryAsync({mediaTypes:MediaTypeOptions.Images,allowsEditing:true,base64:true});if(!result.canceled&&result.assets){var resizedImage=yield resizeImage(result.assets[0].uri);setSrc(resizedImage.uri);if(onChange){onChange(Object.assign({avatarImageFormat:avatarImageFormat},resizedImage));}}});return function pickImage(){return _ref.apply(this,arguments);};}();var resizeImage=function(){var _ref2=_asyncToGenerator(function*(imageUri){return manipulateAsync(imageUri,[{resize:{width:avatarImageWidth,height:avatarImageHeight}}],{format:avatarImageFormat});});return function resizeImage(_x){return _ref2.apply(this,arguments);};}();function shouldShowEditIcon(){if(\"web\"===\"web\"){return shouldShowEditIconIfNoImage&&!src||editAvatarImage&&hovered;}else{return shouldShowEditIconIfNoImage&&!src||editAvatarImage;}}var renderEditIcon=function renderEditIcon(){if(shouldShowEditIcon()&&\"web\"===\"web\"){return React.createElement(Box,{alignItems:\"center\",dangerouslySetInlineStyle:{__style:{backgroundColor:\"rgba(255,255,255,0.8)\",borderRadius:radius}},height:height,justifyContent:\"center\",position:\"absolute\",width:width,zIndex:5,onClick:pickImage,onHoverEnd:function onHoverEnd(){return setHovered(false);},onHoverStart:function onHoverStart(){return setHovered(true);}},React.createElement(Icon,{color:\"darkGray\",name:\"edit\",size:size}),React.createElement(Text,{style:{fontWeight:\"bold\"}},\"Upload Image\"));}else if(shouldShowEditIcon()&&\"web\"!==\"web\"){return React.createElement(Box,{bottom:true,left:Boolean(props.status),paddingX:sizeIconPadding[size],position:\"absolute\",right:!Boolean(props.status),zIndex:5,onClick:pickImage},React.createElement(Icon,{color:\"darkGray\",name:\"edit\",size:size}));}return null;};var renderStatusIcon=function renderStatusIcon(){if(!props.status){return null;}var _statusIcons$props$st=statusIcons[props.status],icon=_statusIcons$props$st.icon,color=_statusIcons$props$st.color;if(props.statusMobile&&[\"online\",\"away\",\"offline\",\"doNotDisturb\"].includes(props.status)){icon=\"mobile-alt\";}if(!icon||!color){console.warn(`Avatar: Invalid status ${props.status}`);return null;}return React.createElement(Box,{bottom:true,paddingX:sizeIconPadding[size],position:\"absolute\",right:true,zIndex:5},React.createElement(Icon,{color:color,name:icon,size:size}));};var avatar=React.createElement(Box,{height:height,position:\"relative\",width:width},React.createElement(Box,{border:outline?\"white\":undefined,height:height,overflow:\"hidden\",position:\"relative\",rounding:\"circle\",width:width,onHoverEnd:function onHoverEnd(){return setHovered(false);},onHoverStart:function onHoverStart(){return setHovered(true);}},src&&isImageLoaded?(React.createElement(Image,{resizeMode:imageFit,source:{uri:src,cache:\"force-cache\"},style:{borderRadius:radius,height:height,width:width,display:\"flex\",alignItems:\"center\",justifyContent:\"center\",overflow:\"hidden\"},onError:handleImageError})):(React.createElement(View,{style:{height:height,width:width,borderRadius:radius,display:\"flex\",alignItems:\"center\",justifyContent:\"center\",backgroundColor:props.backgroundColor?theme[props.backgroundColor]:theme.gray}},React.createElement(Text,{style:{fontSize:fontSize,color:(_b=props.textColor)!==null&&_b!==void 0?_b:theme.darkGray}},computedInitials)))),renderEditIcon(),renderStatusIcon());var status=props.statusText;if(!status&&props.status){status=(_c=statusIcons[props.status])===null||_c===void 0?void 0:_c.label;}if(status){return React.createElement(Box,{width:width},React.createElement(Tooltip,{idealDirection:\"top\",text:isMobileDevice()?undefined:status},avatar));}else{return avatar;}};","map":{"version":3,"sources":["../src/Avatar.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/* eslint-disable no-console */\nimport { manipulateAsync, SaveFormat } from \"expo-image-manipulator\";\nimport { launchImageLibraryAsync, MediaTypeOptions } from \"expo-image-picker\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport { Image, Platform, Text, View } from \"react-native\";\nimport { Box } from \"./Box\";\nimport { Icon } from \"./Icon\";\nimport { isMobileDevice } from \"./MediaQuery\";\nimport { ThemeContext } from \"./Theme\";\nimport { Tooltip } from \"./Tooltip\";\nconst sizes = {\n    xs: 24,\n    sm: 32,\n    md: 48,\n    lg: 64,\n    xl: 120,\n};\nconst sizeIconPadding = {\n    xs: 0,\n    sm: 0,\n    md: 1,\n    lg: 1,\n    xl: 2,\n};\nconst statusIcons = {\n    online: { icon: \"circle\", color: \"green\", label: \"Online\" },\n    offline: { icon: \"circle\", color: \"gray\", label: \"Offline\" },\n    doNotDisturb: { icon: \"minus-circle\", color: \"red\", label: \"Do Not Disturb\" },\n    away: { icon: \"moon\", color: \"orange\", label: \"Away\" },\n    meeting: { icon: \"calendar\", color: \"orange\", label: \"In a Meeting\" },\n    vacation: { icon: \"plane\", color: \"orange\", label: \"On Vacation\" },\n    sick: { icon: \"clinic-medical\", color: \"orange\", label: \"Sick\" },\n    outOfOffice: { icon: \"clock\", color: \"orange\", label: \"Out of Office\" },\n    commuting: { icon: \"car\", color: \"orange\", label: \"Commuting\" },\n};\nexport const Avatar = (props) => {\n    var _a, _b, _c;\n    const { theme } = useContext(ThemeContext);\n    const [isImageLoaded, setIsImageLoaded] = useState(true);\n    const [hovered, setHovered] = useState(false);\n    const [src, setSrc] = useState((_a = props.src) !== null && _a !== void 0 ? _a : undefined);\n    const { name, initials, outline, size = \"md\", imageFit = \"contain\", editAvatarImage, onChange, avatarImageWidth = sizes[size], avatarImageHeight, avatarImageFormat = SaveFormat.PNG, shouldShowEditIconIfNoImage = false, } = props;\n    const width = sizes[size];\n    const height = sizes[size];\n    const radius = sizes[size] / 2;\n    const fontSize = sizes[size] / 2;\n    const computedInitials = initials !== null && initials !== void 0 ? initials : name.match(/(^\\S\\S?|\\s\\S)?/g)\n        .map((v) => v.trim())\n        .join(\"\")\n        .match(/(^\\S|\\S$)?/g)\n        .join(\"\")\n        .toLocaleUpperCase();\n    // If the src changes, update the image.\n    useEffect(() => {\n        setSrc(props.src);\n    }, [props]);\n    if (editAvatarImage && !onChange) {\n        console.warn(\"Avatars with the editAvatarImage flag on should also have an onChange property.\");\n    }\n    const handleImageError = () => {\n        setIsImageLoaded(false);\n        console.warn(\"Image load error\");\n    };\n    const pickImage = async () => {\n        // TODO: Add permission request to use camera to take a picture\n        const result = await launchImageLibraryAsync({\n            mediaTypes: MediaTypeOptions.Images,\n            allowsEditing: true,\n            base64: true,\n        });\n        if (!result.canceled && result.assets) {\n            const resizedImage = await resizeImage(result.assets[0].uri);\n            setSrc(resizedImage.uri);\n            if (onChange) {\n                onChange(Object.assign({ avatarImageFormat }, resizedImage));\n            }\n        }\n    };\n    const resizeImage = async (imageUri) => {\n        return manipulateAsync(imageUri, [{ resize: { width: avatarImageWidth, height: avatarImageHeight } }], { format: avatarImageFormat });\n    };\n    function shouldShowEditIcon() {\n        if (Platform.OS === \"web\") {\n            return (shouldShowEditIconIfNoImage && !src) || (editAvatarImage && hovered);\n        }\n        else {\n            return (shouldShowEditIconIfNoImage && !src) || editAvatarImage;\n        }\n    }\n    const renderEditIcon = () => {\n        if (shouldShowEditIcon() && Platform.OS === \"web\") {\n            return (React.createElement(Box, { alignItems: \"center\", dangerouslySetInlineStyle: {\n                    __style: { backgroundColor: \"rgba(255,255,255,0.8)\", borderRadius: radius },\n                }, height: height, justifyContent: \"center\", position: \"absolute\", width: width, zIndex: 5, onClick: pickImage, onHoverEnd: () => setHovered(false), onHoverStart: () => setHovered(true) },\n                React.createElement(Icon, { color: \"darkGray\", name: \"edit\", size: size }),\n                React.createElement(Text, { style: { fontWeight: \"bold\" } }, \"Upload Image\")));\n        }\n        else if (shouldShowEditIcon() && Platform.OS !== \"web\") {\n            return (React.createElement(Box, { bottom: true, left: Boolean(props.status), paddingX: sizeIconPadding[size], position: \"absolute\", right: !Boolean(props.status), zIndex: 5, onClick: pickImage },\n                React.createElement(Icon, { color: \"darkGray\", name: \"edit\", size: size })));\n        }\n        return null;\n    };\n    const renderStatusIcon = () => {\n        if (!props.status) {\n            return null;\n        }\n        // eslint-disable-next-line prefer-const\n        let { icon, color } = statusIcons[props.status];\n        if (props.statusMobile &&\n            [\"online\", \"away\", \"offline\", \"doNotDisturb\"].includes(props.status)) {\n            icon = \"mobile-alt\";\n        }\n        if (!icon || !color) {\n            console.warn(`Avatar: Invalid status ${props.status}`);\n            return null;\n        }\n        return (React.createElement(Box, { bottom: true, paddingX: sizeIconPadding[size], position: \"absolute\", right: true, zIndex: 5 },\n            React.createElement(Icon, { color: color, name: icon, size: size })));\n    };\n    const avatar = (React.createElement(Box, { height: height, position: \"relative\", width: width },\n        React.createElement(Box, { border: outline ? \"white\" : undefined, height: height, overflow: \"hidden\", position: \"relative\", rounding: \"circle\", width: width, onHoverEnd: () => setHovered(false), onHoverStart: () => setHovered(true) }, src && isImageLoaded ? (\n        // TODO: Make our Image component rounding work so that we can use it for Avatar.\n        // Currently it creates an unrounded box around the Image.\n        React.createElement(Image, { resizeMode: imageFit, source: { uri: src, cache: \"force-cache\" }, style: {\n                borderRadius: radius,\n                height,\n                width,\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                overflow: \"hidden\",\n            }, onError: handleImageError })) : (React.createElement(View, { style: {\n                height,\n                width,\n                borderRadius: radius,\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                backgroundColor: props.backgroundColor ? theme[props.backgroundColor] : theme.gray,\n            } },\n            React.createElement(Text, { style: { fontSize, color: (_b = props.textColor) !== null && _b !== void 0 ? _b : theme.darkGray } }, computedInitials)))),\n        renderEditIcon(),\n        renderStatusIcon()));\n    let status = props.statusText;\n    if (!status && props.status) {\n        status = (_c = statusIcons[props.status]) === null || _c === void 0 ? void 0 : _c.label;\n    }\n    if (status) {\n        // Need to wrap the tooltip so it doesn't expand to 100% width and render the tooltip off.\n        // Don't show the tooltips on mobile because they intercept the edit avatar clicks.\n        return (React.createElement(Box, { width: width },\n            React.createElement(Tooltip, { idealDirection: \"top\", text: isMobileDevice() ? undefined : status }, avatar)));\n    }\n    else {\n        return avatar;\n    }\n};\n//# sourceMappingURL=Avatar.js.map"]},"metadata":{},"sourceType":"module"}