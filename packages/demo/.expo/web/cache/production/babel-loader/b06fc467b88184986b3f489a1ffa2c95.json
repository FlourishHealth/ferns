{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}var InteractionManager=function(){function InteractionManager(){_classCallCheck(this,InteractionManager);_defineProperty(this,\"waitForRelations\",new Map());_defineProperty(this,\"simultaneousRelations\",new Map());_defineProperty(this,\"blocksHandlersRelations\",new Map());}_createClass(InteractionManager,[{key:\"configureInteractions\",value:function configureInteractions(handler,config){this.dropRelationsForHandlerWithTag(handler.getTag());if(config.waitFor){var waitFor=[];config.waitFor.forEach(function(otherHandler){if(typeof otherHandler==='number'){waitFor.push(otherHandler);}else{waitFor.push(otherHandler.handlerTag);}});this.waitForRelations.set(handler.getTag(),waitFor);}if(config.simultaneousHandlers){var simultaneousHandlers=[];config.simultaneousHandlers.forEach(function(otherHandler){if(typeof otherHandler==='number'){simultaneousHandlers.push(otherHandler);}else{simultaneousHandlers.push(otherHandler.handlerTag);}});this.simultaneousRelations.set(handler.getTag(),simultaneousHandlers);}if(config.blocksHandlers){var blocksHandlers=[];config.blocksHandlers.forEach(function(otherHandler){if(typeof otherHandler==='number'){blocksHandlers.push(otherHandler);}else{blocksHandlers.push(otherHandler.handlerTag);}});this.blocksHandlersRelations.set(handler.getTag(),blocksHandlers);}}},{key:\"shouldWaitForHandlerFailure\",value:function shouldWaitForHandlerFailure(handler,otherHandler){var waitFor=this.waitForRelations.get(handler.getTag());return(waitFor===null||waitFor===void 0?void 0:waitFor.find(function(tag){return tag===otherHandler.getTag();}))!==undefined;}},{key:\"shouldRecognizeSimultaneously\",value:function shouldRecognizeSimultaneously(handler,otherHandler){var simultaneousHandlers=this.simultaneousRelations.get(handler.getTag());return(simultaneousHandlers===null||simultaneousHandlers===void 0?void 0:simultaneousHandlers.find(function(tag){return tag===otherHandler.getTag();}))!==undefined;}},{key:\"shouldRequireHandlerToWaitForFailure\",value:function shouldRequireHandlerToWaitForFailure(handler,otherHandler){var waitFor=this.blocksHandlersRelations.get(handler.getTag());return(waitFor===null||waitFor===void 0?void 0:waitFor.find(function(tag){return tag===otherHandler.getTag();}))!==undefined;}},{key:\"shouldHandlerBeCancelledBy\",value:function shouldHandlerBeCancelledBy(_handler,_otherHandler){return false;}},{key:\"dropRelationsForHandlerWithTag\",value:function dropRelationsForHandlerWithTag(handlerTag){this.waitForRelations.delete(handlerTag);this.simultaneousRelations.delete(handlerTag);this.blocksHandlersRelations.delete(handlerTag);}},{key:\"reset\",value:function reset(){this.waitForRelations.clear();this.simultaneousRelations.clear();this.blocksHandlersRelations.clear();}}],[{key:\"getInstance\",value:function getInstance(){if(!this.instance){this.instance=new InteractionManager();}return this.instance;}}]);return InteractionManager;}();export{InteractionManager as default};_defineProperty(InteractionManager,\"instance\",void 0);","map":{"version":3,"sources":["InteractionManager.ts"],"names":["InteractionManager","Map","constructor","configureInteractions","handler","config","dropRelationsForHandlerWithTag","getTag","waitFor","forEach","otherHandler","push","handlerTag","waitForRelations","set","simultaneousHandlers","simultaneousRelations","blocksHandlers","blocksHandlersRelations","shouldWaitForHandlerFailure","get","find","tag","undefined","shouldRecognizeSimultaneously","shouldRequireHandlerToWaitForFailure","shouldHandlerBeCancelledBy","_handler","_otherHandler","delete","reset","clear","getInstance","instance"],"mappings":"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","sourcesContent":["import GestureHandler from '../handlers/GestureHandler';\nimport { Config, Handler } from '../interfaces';\n\nexport default class InteractionManager {\n  private static instance: InteractionManager;\n  private readonly waitForRelations: Map<number, number[]> = new Map();\n  private readonly simultaneousRelations: Map<number, number[]> = new Map();\n  private readonly blocksHandlersRelations: Map<number, number[]> = new Map();\n\n  // Private becaues of singleton\n  // eslint-disable-next-line no-useless-constructor, @typescript-eslint/no-empty-function\n  private constructor() {}\n\n  public configureInteractions(handler: GestureHandler, config: Config) {\n    this.dropRelationsForHandlerWithTag(handler.getTag());\n\n    if (config.waitFor) {\n      const waitFor: number[] = [];\n      config.waitFor.forEach((otherHandler: Handler): void => {\n        // New API reference\n        if (typeof otherHandler === 'number') {\n          waitFor.push(otherHandler);\n        } else {\n          // Old API reference\n          waitFor.push(otherHandler.handlerTag);\n        }\n      });\n\n      this.waitForRelations.set(handler.getTag(), waitFor);\n    }\n\n    if (config.simultaneousHandlers) {\n      const simultaneousHandlers: number[] = [];\n      config.simultaneousHandlers.forEach((otherHandler: Handler): void => {\n        if (typeof otherHandler === 'number') {\n          simultaneousHandlers.push(otherHandler);\n        } else {\n          simultaneousHandlers.push(otherHandler.handlerTag);\n        }\n      });\n\n      this.simultaneousRelations.set(handler.getTag(), simultaneousHandlers);\n    }\n\n    if (config.blocksHandlers) {\n      const blocksHandlers: number[] = [];\n      config.blocksHandlers.forEach((otherHandler: Handler): void => {\n        if (typeof otherHandler === 'number') {\n          blocksHandlers.push(otherHandler);\n        } else {\n          blocksHandlers.push(otherHandler.handlerTag);\n        }\n      });\n\n      this.blocksHandlersRelations.set(handler.getTag(), blocksHandlers);\n    }\n  }\n\n  public shouldWaitForHandlerFailure(\n    handler: GestureHandler,\n    otherHandler: GestureHandler\n  ): boolean {\n    const waitFor: number[] | undefined = this.waitForRelations.get(\n      handler.getTag()\n    );\n\n    return (\n      waitFor?.find((tag: number) => {\n        return tag === otherHandler.getTag();\n      }) !== undefined\n    );\n  }\n\n  public shouldRecognizeSimultaneously(\n    handler: GestureHandler,\n    otherHandler: GestureHandler\n  ): boolean {\n    const simultaneousHandlers: number[] | undefined =\n      this.simultaneousRelations.get(handler.getTag());\n\n    return (\n      simultaneousHandlers?.find((tag: number) => {\n        return tag === otherHandler.getTag();\n      }) !== undefined\n    );\n  }\n\n  public shouldRequireHandlerToWaitForFailure(\n    handler: GestureHandler,\n    otherHandler: GestureHandler\n  ): boolean {\n    const waitFor: number[] | undefined = this.blocksHandlersRelations.get(\n      handler.getTag()\n    );\n\n    return (\n      waitFor?.find((tag: number) => {\n        return tag === otherHandler.getTag();\n      }) !== undefined\n    );\n  }\n\n  public shouldHandlerBeCancelledBy(\n    _handler: GestureHandler,\n    _otherHandler: GestureHandler\n  ): boolean {\n    //TODO: Implement logic\n    return false;\n  }\n\n  public dropRelationsForHandlerWithTag(handlerTag: number): void {\n    this.waitForRelations.delete(handlerTag);\n    this.simultaneousRelations.delete(handlerTag);\n    this.blocksHandlersRelations.delete(handlerTag);\n  }\n\n  public reset() {\n    this.waitForRelations.clear();\n    this.simultaneousRelations.clear();\n    this.blocksHandlersRelations.clear();\n  }\n\n  public static getInstance(): InteractionManager {\n    if (!this.instance) {\n      this.instance = new InteractionManager();\n    }\n\n    return this.instance;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}