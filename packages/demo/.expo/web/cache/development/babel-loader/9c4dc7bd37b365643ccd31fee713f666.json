{"ast":null,"code":"'use strict';\n\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nfunction _defineProperty(obj, key, value) {\n  key = _toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return typeof key === \"symbol\" ? key : String(key);\n}\nfunction _toPrimitive(input, hint) {\n  if (typeof input !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (typeof res !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\nimport { runOnUIImmediately } from '../../threads';\nimport { registerEventHandler, unregisterEventHandler } from '../../core';\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport { isJest, shouldBeUseWeb } from '../../PlatformChecker';\nvar IS_ANDROID = Platform.OS === 'android';\nvar _worklet_733189383917_init_data = {\n  code: \"function anonymous(){const{viewTag,progressAnimation}=this.__closure;global.ProgressTransitionRegister.addProgressAnimation(viewTag,progressAnimation);}\",\n  location: \"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"anonymous\\\",\\\"viewTag\\\",\\\"progressAnimation\\\",\\\"__closure\\\",\\\"global\\\",\\\"ProgressTransitionRegister\\\",\\\"addProgressAnimation\\\"],\\\"sources\\\":[\\\"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\\\"],\\\"mappings\\\":\\\"AAsBuB,SAAAA,SAAMA,CAAA,QAAAC,OAAA,CAAAC,iBAAA,OAAAC,SAAA,CAGvBC,MAAM,CAACC,0BAA0B,CAACC,oBAAoB,CAACL,OAAO,CAAEC,iBAAiB,CAAC,CACpF\\\"}\",\n  version: \"3.6.3\"\n};\nvar _worklet_15289183256234_init_data = {\n  code: \"function anonymous(){const{viewTag}=this.__closure;global.ProgressTransitionRegister.removeProgressAnimation(viewTag);}\",\n  location: \"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"anonymous\\\",\\\"viewTag\\\",\\\"__closure\\\",\\\"global\\\",\\\"ProgressTransitionRegister\\\",\\\"removeProgressAnimation\\\"],\\\"sources\\\":[\\\"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\\\"],\\\"mappings\\\":\\\"AA+BuB,SAAAA,SAAMA,CAAA,QAAAC,OAAA,OAAAC,SAAA,CAGvBC,MAAM,CAACC,0BAA0B,CAACC,uBAAuB,CAACJ,OAAO,CAAC,CACpE\\\"}\",\n  version: \"3.6.3\"\n};\nvar _worklet_7494210000180_init_data = {\n  code: \"function anonymous(event){const{lastProgressValue}=this.__closure;const progress=event.progress;if(progress===lastProgressValue){return;}lastProgressValue=progress;global.ProgressTransitionRegister.frame(progress);}\",\n  location: \"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"anonymous\\\",\\\"event\\\",\\\"lastProgressValue\\\",\\\"__closure\\\",\\\"progress\\\",\\\"global\\\",\\\"ProgressTransitionRegister\\\",\\\"frame\\\"],\\\"sources\\\":[\\\"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\\\"],\\\"mappings\\\":\\\"AA4C+D,SAAAA,SAASA,CAAAC,KAAA,QAAAC,iBAAA,OAAAC,SAAA,CAGhE,KAAM,CAAAC,QAAQ,CAAGH,KAAK,CAACG,QAAQ,CAC/B,GAAIA,QAAQ,GAAKF,iBAAiB,CAAE,CAIlC,OACF,CACAA,iBAAiB,CAAGE,QAAQ,CAC5BC,MAAM,CAACC,0BAA0B,CAACC,KAAK,CAACH,QAAQ,CAAC,CACnD\\\"}\",\n  version: \"3.6.3\"\n};\nvar _worklet_3584216964250_init_data = {\n  code: \"function anonymous(){global.ProgressTransitionRegister.onTransitionEnd();}\",\n  location: \"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"anonymous\\\",\\\"global\\\",\\\"ProgressTransitionRegister\\\",\\\"onTransitionEnd\\\"],\\\"sources\\\":[\\\"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\\\"],\\\"mappings\\\":\\\"AAyDmD,SAAAA,SAAMA,CAAA,EAGjDC,MAAM,CAACC,0BAA0B,CAACC,eAAe,CAAC,CAAC,CACrD\\\"}\",\n  version: \"3.6.3\"\n};\nvar _worklet_3552696675293_init_data = {\n  code: \"function anonymous(){global.ProgressTransitionRegister.onAndroidFinishTransitioning();}\",\n  location: \"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"anonymous\\\",\\\"global\\\",\\\"ProgressTransitionRegister\\\",\\\"onAndroidFinishTransitioning\\\"],\\\"sources\\\":[\\\"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\\\"],\\\"mappings\\\":\\\"AAiEwD,SAAAA,SAAMA,CAAA,EAGpDC,MAAM,CAACC,0BAA0B,CAACC,4BAA4B,CAAC,CAAC,CAClE\\\"}\",\n  version: \"3.6.3\"\n};\nvar _worklet_16472804869484_init_data = {\n  code: \"function anonymous(){global.ProgressTransitionRegister.onTransitionEnd(true);}\",\n  location: \"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"anonymous\\\",\\\"global\\\",\\\"ProgressTransitionRegister\\\",\\\"onTransitionEnd\\\"],\\\"sources\\\":[\\\"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\\\"],\\\"mappings\\\":\\\"AAwEwD,SAAAA,SAAMA,CAAA,EAGpDC,MAAM,CAACC,0BAA0B,CAACC,eAAe,CAAC,IAAI,CAAC,CACzD\\\"}\",\n  version: \"3.6.3\"\n};\nvar _worklet_3584216964250_init_data2 = {\n  code: \"function anonymous(){global.ProgressTransitionRegister.onTransitionEnd();}\",\n  location: \"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"anonymous\\\",\\\"global\\\",\\\"ProgressTransitionRegister\\\",\\\"onTransitionEnd\\\"],\\\"sources\\\":[\\\"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\\\"],\\\"mappings\\\":\\\"AA6E2D,SAAAA,SAAMA,CAAA,EAGvDC,MAAM,CAACC,0BAA0B,CAACC,eAAe,CAAC,CAAC,CACrD\\\"}\",\n  version: \"3.6.3\"\n};\nexport var ProgressTransitionManager = function () {\n  function ProgressTransitionManager() {\n    _classCallCheck(this, ProgressTransitionManager);\n    _defineProperty(this, \"_sharedElementCount\", 0);\n    _defineProperty(this, \"_eventHandler\", {\n      isRegistered: false,\n      onTransitionProgress: -1,\n      onAppear: -1,\n      onDisappear: -1,\n      onSwipeDismiss: -1\n    });\n  }\n  _createClass(ProgressTransitionManager, [{\n    key: \"addProgressAnimation\",\n    value: function addProgressAnimation(viewTag, progressAnimation) {\n      runOnUIImmediately(function () {\n        var _e = [new global.Error(), -3, -27];\n        var anonymous = function anonymous() {\n          global.ProgressTransitionRegister.addProgressAnimation(viewTag, progressAnimation);\n        };\n        anonymous.__closure = {\n          viewTag: viewTag,\n          progressAnimation: progressAnimation\n        };\n        anonymous.__workletHash = 733189383917;\n        anonymous.__initData = _worklet_733189383917_init_data;\n        anonymous.__stackDetails = _e;\n        return anonymous;\n      }())();\n      this.registerEventHandlers();\n    }\n  }, {\n    key: \"removeProgressAnimation\",\n    value: function removeProgressAnimation(viewTag) {\n      this.unregisterEventHandlers();\n      runOnUIImmediately(function () {\n        var _e = [new global.Error(), -2, -27];\n        var anonymous = function anonymous() {\n          global.ProgressTransitionRegister.removeProgressAnimation(viewTag);\n        };\n        anonymous.__closure = {\n          viewTag: viewTag\n        };\n        anonymous.__workletHash = 15289183256234;\n        anonymous.__initData = _worklet_15289183256234_init_data;\n        anonymous.__stackDetails = _e;\n        return anonymous;\n      }())();\n    }\n  }, {\n    key: \"registerEventHandlers\",\n    value: function registerEventHandlers() {\n      this._sharedElementCount++;\n      var eventHandler = this._eventHandler;\n      if (!eventHandler.isRegistered) {\n        eventHandler.isRegistered = true;\n        var eventPrefix = IS_ANDROID ? 'on' : 'top';\n        var lastProgressValue = -1;\n        eventHandler.onTransitionProgress = registerEventHandler(function () {\n          var _e = [new global.Error(), -2, -27];\n          var anonymous = function anonymous(event) {\n            var progress = event.progress;\n            if (progress === lastProgressValue) {\n              return;\n            }\n            lastProgressValue = progress;\n            global.ProgressTransitionRegister.frame(progress);\n          };\n          anonymous.__closure = {\n            lastProgressValue: lastProgressValue\n          };\n          anonymous.__workletHash = 7494210000180;\n          anonymous.__initData = _worklet_7494210000180_init_data;\n          anonymous.__stackDetails = _e;\n          return anonymous;\n        }(), eventPrefix + 'TransitionProgress');\n        eventHandler.onAppear = registerEventHandler(function () {\n          var _e = [new global.Error(), 1, -27];\n          var anonymous = function anonymous() {\n            global.ProgressTransitionRegister.onTransitionEnd();\n          };\n          anonymous.__closure = {};\n          anonymous.__workletHash = 3584216964250;\n          anonymous.__initData = _worklet_3584216964250_init_data;\n          anonymous.__stackDetails = _e;\n          return anonymous;\n        }(), eventPrefix + 'Appear');\n        if (IS_ANDROID) {\n          eventHandler.onDisappear = registerEventHandler(function () {\n            var _e = [new global.Error(), 1, -27];\n            var anonymous = function anonymous() {\n              global.ProgressTransitionRegister.onAndroidFinishTransitioning();\n            };\n            anonymous.__closure = {};\n            anonymous.__workletHash = 3552696675293;\n            anonymous.__initData = _worklet_3552696675293_init_data;\n            anonymous.__stackDetails = _e;\n            return anonymous;\n          }(), 'onFinishTransitioning');\n        } else if (Platform.OS === 'ios') {\n          eventHandler.onDisappear = registerEventHandler(function () {\n            var _e = [new global.Error(), 1, -27];\n            var anonymous = function anonymous() {\n              global.ProgressTransitionRegister.onTransitionEnd(true);\n            };\n            anonymous.__closure = {};\n            anonymous.__workletHash = 16472804869484;\n            anonymous.__initData = _worklet_16472804869484_init_data;\n            anonymous.__stackDetails = _e;\n            return anonymous;\n          }(), 'topDisappear');\n          eventHandler.onSwipeDismiss = registerEventHandler(function () {\n            var _e = [new global.Error(), 1, -27];\n            var anonymous = function anonymous() {\n              global.ProgressTransitionRegister.onTransitionEnd();\n            };\n            anonymous.__closure = {};\n            anonymous.__workletHash = 3584216964250;\n            anonymous.__initData = _worklet_3584216964250_init_data2;\n            anonymous.__stackDetails = _e;\n            return anonymous;\n          }(), 'topGestureCancel');\n        }\n      }\n    }\n  }, {\n    key: \"unregisterEventHandlers\",\n    value: function unregisterEventHandlers() {\n      this._sharedElementCount--;\n      if (this._sharedElementCount === 0) {\n        var eventHandler = this._eventHandler;\n        eventHandler.isRegistered = false;\n        if (eventHandler.onTransitionProgress !== -1) {\n          unregisterEventHandler(eventHandler.onTransitionProgress);\n          eventHandler.onTransitionProgress = -1;\n        }\n        if (eventHandler.onAppear !== -1) {\n          unregisterEventHandler(eventHandler.onAppear);\n          eventHandler.onAppear = -1;\n        }\n        if (eventHandler.onDisappear !== -1) {\n          unregisterEventHandler(eventHandler.onDisappear);\n          eventHandler.onDisappear = -1;\n        }\n        if (eventHandler.onSwipeDismiss !== -1) {\n          unregisterEventHandler(eventHandler.onSwipeDismiss);\n          eventHandler.onSwipeDismiss = -1;\n        }\n      }\n    }\n  }]);\n  return ProgressTransitionManager;\n}();\nvar _worklet_3418788372063_init_data = {\n  code: \"function createProgressTransitionRegister(){const{IS_ANDROID}=this.__closure;const progressAnimations=new Map();const snapshots=new Map();const currentTransitions=new Set();const toRemove=new Set();let skipCleaning=false;let isTransitionRestart=false;const progressTransitionManager={addProgressAnimation:function(viewTag,progressAnimation){if(currentTransitions.size>0){isTransitionRestart=!IS_ANDROID;}progressAnimations.set(viewTag,progressAnimation);},removeProgressAnimation:function(viewTag){if(currentTransitions.size>0){isTransitionRestart=!IS_ANDROID;}toRemove.add(viewTag);},onTransitionStart:function(viewTag,snapshot){skipCleaning=isTransitionRestart;snapshots.set(viewTag,snapshot);currentTransitions.add(viewTag);progressTransitionManager.frame(0);},frame:function(progress){for(const viewTag of currentTransitions){const progressAnimation=progressAnimations.get(viewTag);if(!progressAnimation){continue;}const snapshot=snapshots.get(viewTag);progressAnimation(viewTag,snapshot,progress);}},onAndroidFinishTransitioning:function(){if(toRemove.size>0){progressTransitionManager.onTransitionEnd();}},onTransitionEnd:function(){let removeViews=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(currentTransitions.size===0){toRemove.clear();return;}if(skipCleaning){skipCleaning=false;isTransitionRestart=false;return;}for(const viewTag of currentTransitions){_notifyAboutEnd(viewTag,removeViews);}currentTransitions.clear();if(isTransitionRestart){return;}snapshots.clear();if(toRemove.size>0){for(const viewTag of toRemove){progressAnimations.delete(viewTag);_notifyAboutEnd(viewTag,removeViews);}toRemove.clear();}}};return progressTransitionManager;}\",\n  location: \"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"createProgressTransitionRegister\\\",\\\"IS_ANDROID\\\",\\\"__closure\\\",\\\"progressAnimations\\\",\\\"Map\\\",\\\"snapshots\\\",\\\"currentTransitions\\\",\\\"Set\\\",\\\"toRemove\\\",\\\"skipCleaning\\\",\\\"isTransitionRestart\\\",\\\"progressTransitionManager\\\",\\\"addProgressAnimation\\\",\\\"viewTag\\\",\\\"progressAnimation\\\",\\\"size\\\",\\\"set\\\",\\\"removeProgressAnimation\\\",\\\"add\\\",\\\"onTransitionStart\\\",\\\"snapshot\\\",\\\"frame\\\",\\\"progress\\\",\\\"get\\\",\\\"onAndroidFinishTransitioning\\\",\\\"onTransitionEnd\\\",\\\"removeViews\\\",\\\"arguments\\\",\\\"length\\\",\\\"undefined\\\",\\\"clear\\\",\\\"_notifyAboutEnd\\\",\\\"delete\\\"],\\\"sources\\\":[\\\"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\\\"],\\\"mappings\\\":\\\"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\\\"}\",\n  version: \"3.6.3\"\n};\nvar createProgressTransitionRegister = function () {\n  var _e = [new global.Error(), -2, -27];\n  var createProgressTransitionRegister = function createProgressTransitionRegister() {\n    var progressAnimations = new Map();\n    var snapshots = new Map();\n    var currentTransitions = new Set();\n    var toRemove = new Set();\n    var skipCleaning = false;\n    var isTransitionRestart = false;\n    var progressTransitionManager = {\n      addProgressAnimation: function addProgressAnimation(viewTag, progressAnimation) {\n        if (currentTransitions.size > 0) {\n          isTransitionRestart = !IS_ANDROID;\n        }\n        progressAnimations.set(viewTag, progressAnimation);\n      },\n      removeProgressAnimation: function removeProgressAnimation(viewTag) {\n        if (currentTransitions.size > 0) {\n          isTransitionRestart = !IS_ANDROID;\n        }\n        toRemove.add(viewTag);\n      },\n      onTransitionStart: function onTransitionStart(viewTag, snapshot) {\n        skipCleaning = isTransitionRestart;\n        snapshots.set(viewTag, snapshot);\n        currentTransitions.add(viewTag);\n        progressTransitionManager.frame(0);\n      },\n      frame: function frame(progress) {\n        for (var viewTag of currentTransitions) {\n          var progressAnimation = progressAnimations.get(viewTag);\n          if (!progressAnimation) {\n            continue;\n          }\n          var snapshot = snapshots.get(viewTag);\n          progressAnimation(viewTag, snapshot, progress);\n        }\n      },\n      onAndroidFinishTransitioning: function onAndroidFinishTransitioning() {\n        if (toRemove.size > 0) {\n          progressTransitionManager.onTransitionEnd();\n        }\n      },\n      onTransitionEnd: function onTransitionEnd() {\n        var removeViews = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n        if (currentTransitions.size === 0) {\n          toRemove.clear();\n          return;\n        }\n        if (skipCleaning) {\n          skipCleaning = false;\n          isTransitionRestart = false;\n          return;\n        }\n        for (var viewTag of currentTransitions) {\n          _notifyAboutEnd(viewTag, removeViews);\n        }\n        currentTransitions.clear();\n        if (isTransitionRestart) {\n          return;\n        }\n        snapshots.clear();\n        if (toRemove.size > 0) {\n          for (var _viewTag of toRemove) {\n            progressAnimations.delete(_viewTag);\n            _notifyAboutEnd(_viewTag, removeViews);\n          }\n          toRemove.clear();\n        }\n      }\n    };\n    return progressTransitionManager;\n  };\n  createProgressTransitionRegister.__closure = {\n    IS_ANDROID: IS_ANDROID\n  };\n  createProgressTransitionRegister.__workletHash = 3418788372063;\n  createProgressTransitionRegister.__initData = _worklet_3418788372063_init_data;\n  createProgressTransitionRegister.__stackDetails = _e;\n  return createProgressTransitionRegister;\n}();\nvar _worklet_7089923520308_init_data = {\n  code: \"function anonymous(){const{createProgressTransitionRegister}=this.__closure;global.ProgressTransitionRegister=createProgressTransitionRegister();}\",\n  location: \"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\",\n  sourceMap: \"{\\\"version\\\":3,\\\"names\\\":[\\\"anonymous\\\",\\\"createProgressTransitionRegister\\\",\\\"__closure\\\",\\\"global\\\",\\\"ProgressTransitionRegister\\\"],\\\"sources\\\":[\\\"/Users/josh/src/ui/node_modules/react-native-reanimated/lib/module/reanimated2/layoutReanimation/sharedTransitions/ProgressTransitionManager.js\\\"],\\\"mappings\\\":\\\"AA6MqB,SAAAA,SAAMA,CAAA,QAAAC,gCAAA,OAAAC,SAAA,CAGvBC,MAAM,CAACC,0BAA0B,CAAGH,gCAAgC,CAAC,CAAC,CACxE\\\"}\",\n  version: \"3.6.3\"\n};\nif (shouldBeUseWeb()) {\n  var maybeThrowError = function maybeThrowError() {\n    if (!isJest()) {\n      throw new Error('[Reanimated] `ProgressTransitionRegister` is not available on non-native platform.');\n    }\n  };\n  global.ProgressTransitionRegister = new Proxy({}, {\n    get: maybeThrowError,\n    set: function set() {\n      maybeThrowError();\n      return false;\n    }\n  });\n} else {\n  runOnUIImmediately(function () {\n    var _e = [new global.Error(), -2, -27];\n    var anonymous = function anonymous() {\n      global.ProgressTransitionRegister = createProgressTransitionRegister();\n    };\n    anonymous.__closure = {\n      createProgressTransitionRegister: createProgressTransitionRegister\n    };\n    anonymous.__workletHash = 7089923520308;\n    anonymous.__initData = _worklet_7089923520308_init_data;\n    anonymous.__stackDetails = _e;\n    return anonymous;\n  }())();\n}","map":{"version":3,"sources":["ProgressTransitionManager.ts"],"names":["runOnUIImmediately","registerEventHandler","unregisterEventHandler","isJest","shouldBeUseWeb","IS_ANDROID","Platform","OS","ProgressTransitionManager","constructor","_defineProperty","isRegistered","onTransitionProgress","onAppear","onDisappear","onSwipeDismiss","addProgressAnimation","viewTag","progressAnimation","global","ProgressTransitionRegister","registerEventHandlers","removeProgressAnimation","unregisterEventHandlers","_sharedElementCount","eventHandler","_eventHandler","eventPrefix","lastProgressValue","event","progress","frame","onTransitionEnd","onAndroidFinishTransitioning","createProgressTransitionRegister","progressAnimations","Map","snapshots","currentTransitions","Set","toRemove","skipCleaning","isTransitionRestart","progressTransitionManager","size","set","add","onTransitionStart","snapshot","get","removeViews","clear","_notifyAboutEnd","delete","maybeThrowError","Error","Proxy"],"mappings":"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","sourcesContent":["'use strict';\nimport { runOnUIImmediately } from '../../threads';\nimport type {\n  ProgressAnimation,\n  SharedTransitionAnimationsValues,\n} from '../animationBuilder/commonTypes';\nimport { registerEventHandler, unregisterEventHandler } from '../../core';\nimport { Platform } from 'react-native';\nimport { isJest, shouldBeUseWeb } from '../../PlatformChecker';\n\ntype TransitionProgressEvent = {\n  closing: number;\n  goingForward: number;\n  eventName: string;\n  progress: number;\n  target: number;\n};\n\nconst IS_ANDROID = Platform.OS === 'android';\n\nexport class ProgressTransitionManager {\n  private _sharedElementCount = 0;\n  private _eventHandler = {\n    isRegistered: false,\n    onTransitionProgress: -1,\n    onAppear: -1,\n    onDisappear: -1,\n    onSwipeDismiss: -1,\n  };\n\n  public addProgressAnimation(\n    viewTag: number,\n    progressAnimation: ProgressAnimation\n  ) {\n    runOnUIImmediately(() => {\n      'worklet';\n      global.ProgressTransitionRegister.addProgressAnimation(\n        viewTag,\n        progressAnimation\n      );\n    })();\n    this.registerEventHandlers();\n  }\n\n  public removeProgressAnimation(viewTag: number) {\n    this.unregisterEventHandlers();\n    runOnUIImmediately(() => {\n      'worklet';\n      global.ProgressTransitionRegister.removeProgressAnimation(viewTag);\n    })();\n  }\n\n  private registerEventHandlers() {\n    this._sharedElementCount++;\n    const eventHandler = this._eventHandler;\n    if (!eventHandler.isRegistered) {\n      eventHandler.isRegistered = true;\n      const eventPrefix = IS_ANDROID ? 'on' : 'top';\n      let lastProgressValue = -1;\n      eventHandler.onTransitionProgress = registerEventHandler(\n        (event: TransitionProgressEvent) => {\n          'worklet';\n          const progress = event.progress;\n          if (progress === lastProgressValue) {\n            // During screen transition, handler receives two events with the same progress\n            // value for both screens, but for modals, there is only one event. To optimize\n            // performance and avoid unnecessary worklet calls, let's skip the second event.\n            return;\n          }\n          lastProgressValue = progress;\n          global.ProgressTransitionRegister.frame(progress);\n        },\n        eventPrefix + 'TransitionProgress'\n      );\n      eventHandler.onAppear = registerEventHandler(() => {\n        'worklet';\n        global.ProgressTransitionRegister.onTransitionEnd();\n      }, eventPrefix + 'Appear');\n\n      if (IS_ANDROID) {\n        // onFinishTransitioning event is available only on Android and\n        // is used to handle closing modals\n        eventHandler.onDisappear = registerEventHandler(() => {\n          'worklet';\n          global.ProgressTransitionRegister.onAndroidFinishTransitioning();\n        }, 'onFinishTransitioning');\n      } else if (Platform.OS === 'ios') {\n        // topDisappear event is required to handle closing modals on iOS\n        eventHandler.onDisappear = registerEventHandler(() => {\n          'worklet';\n          global.ProgressTransitionRegister.onTransitionEnd(true);\n        }, 'topDisappear');\n        eventHandler.onSwipeDismiss = registerEventHandler(() => {\n          'worklet';\n          global.ProgressTransitionRegister.onTransitionEnd();\n        }, 'topGestureCancel');\n      }\n    }\n  }\n\n  private unregisterEventHandlers(): void {\n    this._sharedElementCount--;\n    if (this._sharedElementCount === 0) {\n      const eventHandler = this._eventHandler;\n      eventHandler.isRegistered = false;\n      if (eventHandler.onTransitionProgress !== -1) {\n        unregisterEventHandler(eventHandler.onTransitionProgress);\n        eventHandler.onTransitionProgress = -1;\n      }\n      if (eventHandler.onAppear !== -1) {\n        unregisterEventHandler(eventHandler.onAppear);\n        eventHandler.onAppear = -1;\n      }\n      if (eventHandler.onDisappear !== -1) {\n        unregisterEventHandler(eventHandler.onDisappear);\n        eventHandler.onDisappear = -1;\n      }\n      if (eventHandler.onSwipeDismiss !== -1) {\n        unregisterEventHandler(eventHandler.onSwipeDismiss);\n        eventHandler.onSwipeDismiss = -1;\n      }\n    }\n  }\n}\n\nfunction createProgressTransitionRegister() {\n  'worklet';\n  const progressAnimations = new Map<number, ProgressAnimation>();\n  const snapshots = new Map<\n    number,\n    Partial<SharedTransitionAnimationsValues>\n  >();\n  const currentTransitions = new Set<number>();\n  const toRemove = new Set<number>();\n\n  let skipCleaning = false;\n  let isTransitionRestart = false;\n\n  const progressTransitionManager = {\n    addProgressAnimation: (\n      viewTag: number,\n      progressAnimation: ProgressAnimation\n    ) => {\n      if (currentTransitions.size > 0) {\n        // there is no need to prevent cleaning on android\n        isTransitionRestart = !IS_ANDROID;\n      }\n      progressAnimations.set(viewTag, progressAnimation);\n    },\n    removeProgressAnimation: (viewTag: number) => {\n      if (currentTransitions.size > 0) {\n        // there is no need to prevent cleaning on android\n        isTransitionRestart = !IS_ANDROID;\n      }\n      // Remove the animation config after the transition is finished\n      toRemove.add(viewTag);\n    },\n    onTransitionStart: (\n      viewTag: number,\n      snapshot: Partial<SharedTransitionAnimationsValues>\n    ) => {\n      skipCleaning = isTransitionRestart;\n      snapshots.set(viewTag, snapshot);\n      currentTransitions.add(viewTag);\n      // set initial style for re-parented components\n      progressTransitionManager.frame(0);\n    },\n    frame: (progress: number) => {\n      for (const viewTag of currentTransitions) {\n        const progressAnimation = progressAnimations.get(viewTag);\n        if (!progressAnimation) {\n          continue;\n        }\n        const snapshot = snapshots.get(\n          viewTag\n        )! as SharedTransitionAnimationsValues;\n        progressAnimation!(viewTag, snapshot, progress);\n      }\n    },\n    onAndroidFinishTransitioning: () => {\n      if (toRemove.size > 0) {\n        // it should be ran only on modal closing\n        progressTransitionManager.onTransitionEnd();\n      }\n    },\n    onTransitionEnd: (removeViews = false) => {\n      if (currentTransitions.size === 0) {\n        toRemove.clear();\n        return;\n      }\n      if (skipCleaning) {\n        skipCleaning = false;\n        isTransitionRestart = false;\n        return;\n      }\n      for (const viewTag of currentTransitions) {\n        _notifyAboutEnd(viewTag, removeViews);\n      }\n      currentTransitions.clear();\n      if (isTransitionRestart) {\n        // on transition restart, progressAnimations should be saved\n        // because they potentially can be used in the next transition\n        return;\n      }\n      snapshots.clear();\n      if (toRemove.size > 0) {\n        for (const viewTag of toRemove) {\n          progressAnimations.delete(viewTag);\n          _notifyAboutEnd(viewTag, removeViews);\n        }\n        toRemove.clear();\n      }\n    },\n  };\n  return progressTransitionManager;\n}\n\nif (shouldBeUseWeb()) {\n  const maybeThrowError = () => {\n    // Jest attempts to access a property of this object to check if it is a Jest mock\n    // so we can't throw an error in the getter.\n    if (!isJest()) {\n      throw new Error(\n        '[Reanimated] `ProgressTransitionRegister` is not available on non-native platform.'\n      );\n    }\n  };\n  global.ProgressTransitionRegister = new Proxy(\n    {} as ProgressTransitionRegister,\n    {\n      get: maybeThrowError,\n      set: () => {\n        maybeThrowError();\n        return false;\n      },\n    }\n  );\n} else {\n  runOnUIImmediately(() => {\n    'worklet';\n    global.ProgressTransitionRegister = createProgressTransitionRegister();\n  })();\n}\n\nexport type ProgressTransitionRegister = ReturnType<\n  typeof createProgressTransitionRegister\n>;\n"]},"metadata":{},"sourceType":"module"}